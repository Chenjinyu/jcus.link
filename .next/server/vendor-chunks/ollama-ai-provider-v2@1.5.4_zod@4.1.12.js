"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/ollama-ai-provider-v2@1.5.4_zod@4.1.12";
exports.ids = ["vendor-chunks/ollama-ai-provider-v2@1.5.4_zod@4.1.12"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/ollama-ai-provider-v2@1.5.4_zod@4.1.12/node_modules/ollama-ai-provider-v2/dist/index.mjs":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/ollama-ai-provider-v2@1.5.4_zod@4.1.12/node_modules/ollama-ai-provider-v2/dist/index.mjs ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createOllama: () => (/* binding */ createOllama),\n/* harmony export */   ollama: () => (/* binding */ ollama)\n/* harmony export */ });\n/* harmony import */ var _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ai-sdk/provider */ \"(ssr)/./node_modules/.pnpm/@ai-sdk+provider@2.0.0/node_modules/@ai-sdk/provider/dist/index.mjs\");\n/* harmony import */ var _ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ai-sdk/provider-utils */ \"(ssr)/./node_modules/.pnpm/@ai-sdk+provider-utils@3.0.17_zod@4.1.12/node_modules/@ai-sdk/provider-utils/dist/index.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod/v4 */ \"(ssr)/./node_modules/.pnpm/zod@4.1.12/node_modules/zod/v4/index.js\");\n// src/ollama-provider.ts\n\n\n\n// src/completion/ollama-completion-language-model.ts\n\n\n\n// src/completion/ollama-error.ts\n\n\nvar ollamaErrorDataSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n  error: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    message: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n    // The additional information below is handled loosely to support\n    // Ollama-compatible providers that have slightly different error\n    // responses:\n    type: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string().nullish(),\n    param: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.any().nullish(),\n    code: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.union([zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(), zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number()]).nullish()\n  })\n});\nvar ollamaFailedResponseHandler = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonErrorResponseHandler)({\n  errorSchema: ollamaErrorDataSchema,\n  errorToMessage: (data) => data.error.message\n});\n\n// src/adaptors/convert-to-ollama-completion-prompt.ts\n\nfunction convertToOllamaCompletionPrompt({\n  prompt,\n  user = \"user\",\n  assistant = \"assistant\"\n}) {\n  let text = \"\";\n  if (prompt[0].role === \"system\") {\n    text += `${prompt[0].content}\n\n`;\n    prompt = prompt.slice(1);\n  }\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case \"system\": {\n        throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.InvalidPromptError({\n          message: \"Unexpected system message in prompt: ${content}\",\n          prompt\n        });\n      }\n      case \"user\": {\n        const userMessage = content.map((part) => {\n          switch (part.type) {\n            case \"text\": {\n              return part.text;\n            }\n          }\n        }).filter(Boolean).join(\"\");\n        text += `${user}:\n${userMessage}\n\n`;\n        break;\n      }\n      case \"assistant\": {\n        const assistantMessage = content.map((part) => {\n          switch (part.type) {\n            case \"text\": {\n              return part.text;\n            }\n            case \"tool-call\": {\n              throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.UnsupportedFunctionalityError({\n                functionality: \"tool-call messages\"\n              });\n            }\n          }\n        }).join(\"\");\n        text += `${assistant}:\n${assistantMessage}\n\n`;\n        break;\n      }\n      case \"tool\": {\n        throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.UnsupportedFunctionalityError({\n          functionality: \"tool messages\"\n        });\n      }\n      default: {\n        const _exhaustiveCheck = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n  text += `${assistant}:\n`;\n  return {\n    prompt: text,\n    stopSequences: [`\n${user}:`]\n  };\n}\n\n// src/adaptors/map-ollama-finish-reason.ts\nfunction mapOllamaFinishReason(finishReason) {\n  switch (finishReason) {\n    case \"stop\":\n      return \"stop\";\n    case \"length\":\n      return \"length\";\n    case \"content_filter\":\n      return \"content-filter\";\n    case \"function_call\":\n    case \"tool_calls\":\n      return \"tool-calls\";\n    default:\n      return \"unknown\";\n  }\n}\n\n// src/common/get-response-metadata.ts\nfunction getResponseMetadata({\n  model,\n  created_at\n}) {\n  return {\n    id: void 0,\n    modelId: model != null ? model : void 0,\n    timestamp: created_at != null ? new Date(created_at) : void 0\n  };\n}\n\n// src/completion/ollama-completion-language-model.ts\nvar ollamaCompletionProviderOptions = zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n  think: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.boolean().optional(),\n  user: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n  suffix: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n  echo: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.boolean().optional()\n});\nvar OllamaCompletionLanguageModel = class {\n  constructor(modelId, settings, config) {\n    this.specificationVersion = \"v2\";\n    this.supportedUrls = {\n      // No URLs are supported for completion models.\n    };\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  async getArgs({\n    prompt,\n    maxOutputTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences: userStopSequences,\n    responseFormat,\n    tools,\n    toolChoice,\n    seed,\n    providerOptions\n  }) {\n    var _a;\n    const warnings = [];\n    const ollamaOptions = (_a = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.parseProviderOptions)({\n      provider: \"ollama\",\n      providerOptions,\n      schema: ollamaCompletionProviderOptions\n    })) != null ? _a : {};\n    if (topK != null) {\n      warnings.push({\n        type: \"unsupported-setting\",\n        setting: \"topK\"\n      });\n    }\n    if (tools == null ? void 0 : tools.length) {\n      warnings.push({ type: \"unsupported-setting\", setting: \"tools\" });\n    }\n    if (toolChoice != null) {\n      warnings.push({ type: \"unsupported-setting\", setting: \"toolChoice\" });\n    }\n    if (responseFormat != null && responseFormat.type !== \"text\") {\n      warnings.push({\n        type: \"unsupported-setting\",\n        setting: \"responseFormat\",\n        details: \"JSON response format is not supported.\"\n      });\n    }\n    const { prompt: completionPrompt, stopSequences } = convertToOllamaCompletionPrompt({ prompt });\n    const stop = [...stopSequences != null ? stopSequences : [], ...userStopSequences != null ? userStopSequences : []];\n    return {\n      args: {\n        // model id:\n        model: this.modelId,\n        // Ollama-supported settings:\n        user: ollamaOptions.user,\n        think: ollamaOptions.think,\n        // standardized settings:\n        max_tokens: maxOutputTokens,\n        temperature,\n        top_p: topP,\n        frequency_penalty: frequencyPenalty,\n        presence_penalty: presencePenalty,\n        stop,\n        // prompt:\n        prompt: completionPrompt,\n        // other settings:\n        suffix: ollamaOptions.suffix,\n        echo: ollamaOptions.echo,\n        stream: false\n        // always disabled for doGenerate\n      },\n      warnings\n    };\n  }\n  async doGenerate(options) {\n    var _a, _b, _c, _d;\n    const { args: body, warnings } = await this.getArgs(options);\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse\n    } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.postJsonToApi)({\n      url: this.config.url({\n        path: \"/generate\",\n        modelId: this.modelId\n      }),\n      headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.combineHeaders)(this.config.headers(), options.headers),\n      body: { ...body, stream: false },\n      failedResponseHandler: ollamaFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonResponseHandler)(\n        baseOllamaResponseSchema\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch\n    });\n    const { prompt: rawPrompt, ...rawSettings } = body;\n    const providerMetadata = { ollama: {} };\n    return {\n      content: [\n        {\n          type: \"text\",\n          text: response.response\n        }\n      ],\n      usage: {\n        inputTokens: (_a = response.prompt_eval_count) != null ? _a : void 0,\n        outputTokens: (_b = response.eval_count) != null ? _b : void 0,\n        totalTokens: ((_c = response.prompt_eval_count) != null ? _c : 0) + ((_d = response.eval_count) != null ? _d : 0)\n      },\n      finishReason: mapOllamaFinishReason(\"stop\"),\n      request: { body: JSON.stringify(body) },\n      response: {\n        ...getResponseMetadata(response),\n        headers: responseHeaders,\n        body: rawResponse\n      },\n      warnings,\n      providerMetadata\n    };\n  }\n  async doStream(options) {\n    const { args, warnings } = await this.getArgs(options);\n    const body = {\n      ...args,\n      stream: true\n    };\n    const { responseHeaders, value: response } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.postJsonToApi)({\n      url: this.config.url({\n        path: \"/generate\",\n        modelId: this.modelId\n      }),\n      headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.combineHeaders)(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: ollamaFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonStreamResponseHandler)(\n        baseOllamaResponseSchema\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch\n    });\n    const { prompt: rawPrompt, ...rawSettings } = args;\n    let finishReason = \"unknown\";\n    let usage = {\n      inputTokens: void 0,\n      outputTokens: void 0,\n      totalTokens: void 0\n    };\n    let isFirstChunk = true;\n    return {\n      stream: response.pipeThrough(\n        new TransformStream({\n          transform(chunk, controller) {\n            if (!chunk.success) {\n              finishReason = \"error\";\n              controller.enqueue({ type: \"error\", error: chunk.error });\n              return;\n            }\n            const value = chunk.value;\n            if (\"error\" in value) {\n              finishReason = \"error\";\n              controller.enqueue({ type: \"error\", error: value.error });\n              return;\n            }\n            if (isFirstChunk) {\n              isFirstChunk = false;\n              controller.enqueue({\n                type: \"response-metadata\",\n                ...getResponseMetadata(value)\n              });\n            }\n            if (value.done) {\n              finishReason = mapOllamaFinishReason(\"stop\");\n            }\n            if (value.response != null) {\n              controller.enqueue({\n                type: \"text-delta\",\n                id: \"0\",\n                delta: value.response\n              });\n            }\n          },\n          flush(controller) {\n            controller.enqueue({\n              type: \"finish\",\n              finishReason,\n              usage\n            });\n          }\n        })\n      ),\n      request: { body: JSON.stringify(body) },\n      response: { headers: responseHeaders }\n    };\n  }\n};\nvar baseOllamaResponseSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n  model: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n  created_at: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n  response: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n  done: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.boolean(),\n  context: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number()),\n  eval_count: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  eval_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  load_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  total_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  prompt_eval_count: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  prompt_eval_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional()\n});\n\n// src/embedding/ollama-embedding-model.ts\n\n\n\nvar ollamaEmbeddingProviderOptions = zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n  dimensions: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  truncate: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.boolean().optional(),\n  keepAlive: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string().optional()\n});\nvar OllamaEmbeddingModel = class {\n  constructor(modelId, settings, config) {\n    this.specificationVersion = \"v2\";\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  get maxEmbeddingsPerCall() {\n    var _a;\n    return (_a = this.settings.maxEmbeddingsPerCall) != null ? _a : 2048;\n  }\n  get supportsParallelCalls() {\n    var _a;\n    return (_a = this.settings.supportsParallelCalls) != null ? _a : true;\n  }\n  async getArgs({\n    values,\n    providerOptions\n  }) {\n    var _a, _b;\n    const ollamaOptions = (_a = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.parseProviderOptions)({\n      provider: \"ollama\",\n      providerOptions,\n      schema: ollamaEmbeddingProviderOptions\n    })) != null ? _a : {};\n    return {\n      args: {\n        // model id:\n        model: this.modelId,\n        input: values,\n        // advanced parameters:\n        dimensions: (_b = ollamaOptions.dimensions) != null ? _b : this.settings.dimensions,\n        truncate: ollamaOptions.truncate,\n        keep_alive: ollamaOptions.keepAlive\n      }\n    };\n  }\n  async doEmbed({\n    values,\n    headers,\n    abortSignal,\n    providerOptions\n  }) {\n    if (values.length > this.maxEmbeddingsPerCall) {\n      throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.TooManyEmbeddingValuesForCallError({\n        provider: this.provider,\n        modelId: this.modelId,\n        maxEmbeddingsPerCall: this.maxEmbeddingsPerCall,\n        values\n      });\n    }\n    const { args: body } = await this.getArgs({ values, providerOptions });\n    const {\n      responseHeaders,\n      value: response,\n      rawValue\n    } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.postJsonToApi)({\n      url: this.config.url({\n        path: \"/embed\",\n        modelId: this.modelId\n      }),\n      headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.combineHeaders)(this.config.headers(), headers),\n      body: { ...body },\n      failedResponseHandler: ollamaFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonResponseHandler)(\n        ollamaTextEmbeddingResponseSchema\n      ),\n      abortSignal,\n      fetch: this.config.fetch\n    });\n    return {\n      embeddings: response.embeddings.map((item) => item),\n      usage: { tokens: response.prompt_eval_count },\n      response: { headers: responseHeaders, body: rawValue }\n    };\n  }\n};\nvar ollamaTextEmbeddingResponseSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n  model: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n  embeddings: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number())),\n  total_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number(),\n  load_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number(),\n  prompt_eval_count: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number()\n});\n\n// src/responses/ollama-responses-language-model.ts\n\n\n// src/responses/ollama-responses-request-builder.ts\n\n\n// src/responses/convert-to-ollama-responses-messages.ts\n\nfunction convertToOllamaResponsesMessages({\n  prompt,\n  systemMessageMode\n}) {\n  const messages = [];\n  const warnings = [];\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case \"system\": {\n        switch (systemMessageMode) {\n          case \"system\": {\n            messages.push({ role: \"system\", content });\n            break;\n          }\n          case \"developer\": {\n            messages.push({ role: \"developer\", content });\n            break;\n          }\n          case \"remove\": {\n            warnings.push({\n              type: \"other\",\n              message: \"system messages are removed for this model\"\n            });\n            break;\n          }\n          default: {\n            const _exhaustiveCheck = systemMessageMode;\n            throw new Error(\n              `Unsupported system message mode: ${_exhaustiveCheck}`\n            );\n          }\n        }\n        break;\n      }\n      case \"user\": {\n        messages.push({\n          role: \"user\",\n          content: content.map((part, index) => {\n            var _a, _b, _c;\n            switch (part.type) {\n              case \"text\": {\n                return { type: \"input_text\", text: part.text };\n              }\n              case \"file\": {\n                if (part.mediaType.startsWith(\"image/\")) {\n                  const mediaType = part.mediaType === \"image/*\" ? \"image/jpeg\" : part.mediaType;\n                  return {\n                    type: \"input_image\",\n                    image_url: part.data instanceof URL ? part.data.toString() : `data:${mediaType};base64,${part.data}`,\n                    // Ollama specific extension: image detail\n                    detail: (_b = (_a = part.providerOptions) == null ? void 0 : _a.ollama) == null ? void 0 : _b.imageDetail\n                  };\n                } else if (part.mediaType === \"application/pdf\") {\n                  if (part.data instanceof URL) {\n                    throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.UnsupportedFunctionalityError({\n                      functionality: \"PDF file parts with URLs\"\n                    });\n                  }\n                  return {\n                    type: \"input_file\",\n                    filename: (_c = part.filename) != null ? _c : `part-${index}.pdf`,\n                    file_data: `data:application/pdf;base64,${part.data}`\n                  };\n                } else {\n                  throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.UnsupportedFunctionalityError({\n                    functionality: `file part media type ${part.mediaType}`\n                  });\n                }\n              }\n            }\n          })\n        });\n        break;\n      }\n      case \"assistant\": {\n        for (const part of content) {\n          switch (part.type) {\n            case \"text\": {\n              messages.push({\n                role: \"assistant\",\n                content: [{ type: \"output_text\", text: part.text }]\n              });\n              break;\n            }\n            case \"tool-call\": {\n              if (part.providerExecuted) {\n                break;\n              }\n              messages.push({\n                type: \"function_call\",\n                call_id: part.toolCallId,\n                name: part.toolName,\n                arguments: JSON.stringify(part.input)\n              });\n              break;\n            }\n            case \"tool-result\": {\n              warnings.push({\n                type: \"other\",\n                message: `tool result parts in assistant messages are not supported for Ollama responses`\n              });\n              break;\n            }\n          }\n        }\n        break;\n      }\n      case \"tool\": {\n        for (const part of content) {\n          const output = part.output;\n          let contentValue;\n          switch (output.type) {\n            case \"text\":\n            case \"error-text\":\n              contentValue = output.value;\n              break;\n            case \"content\":\n            case \"json\":\n            case \"error-json\":\n              contentValue = JSON.stringify(output.value);\n              break;\n          }\n          messages.push({\n            type: \"function_call_output\",\n            call_id: part.toolCallId,\n            output: contentValue\n          });\n        }\n        break;\n      }\n      default: {\n        const _exhaustiveCheck = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n  return { messages, warnings };\n}\n\n// src/adaptors/convert-to-ollama-chat-messages.ts\nfunction convertToOllamaChatMessages({\n  prompt,\n  systemMessageMode = \"system\"\n}) {\n  const messages = [];\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case \"system\": {\n        switch (systemMessageMode) {\n          case \"system\": {\n            messages.push({ role: \"system\", content });\n            break;\n          }\n          case \"developer\": {\n            messages.push({ role: \"developer\", content });\n            break;\n          }\n          case \"remove\": {\n            break;\n          }\n          default: {\n            const _exhaustiveCheck = systemMessageMode;\n            throw new Error(\n              `Unsupported system message mode: ${_exhaustiveCheck}`\n            );\n          }\n        }\n        break;\n      }\n      case \"user\": {\n        if (content.length === 1 && content[0].type === \"text\") {\n          messages.push({ role: \"user\", content: content[0].text });\n          break;\n        }\n        const userText = content.filter((part) => part.type === \"text\").map((part) => part.text).join(\"\");\n        const images = content.filter((part) => part.type === \"file\" && part.mediaType.startsWith(\"image/\")).map((part) => part.data);\n        messages.push({\n          role: \"user\",\n          content: userText.length > 0 ? userText : [],\n          images: images.length > 0 ? images : void 0\n        });\n        break;\n      }\n      case \"assistant\": {\n        let text = \"\";\n        let thinking = \"\";\n        const toolCalls = [];\n        for (const part of content) {\n          switch (part.type) {\n            case \"text\": {\n              text += part.text;\n              break;\n            }\n            case \"tool-call\": {\n              toolCalls.push({\n                id: part.toolCallId,\n                type: \"function\",\n                function: {\n                  name: part.toolName,\n                  arguments: part.input\n                }\n              });\n              break;\n            }\n            case \"reasoning\": {\n              thinking += part.text;\n              break;\n            }\n            default: {\n              throw new Error(`Unsupported part: ${part}`);\n            }\n          }\n        }\n        messages.push({\n          role: \"assistant\",\n          content: text,\n          ...thinking && { thinking },\n          tool_calls: toolCalls.length > 0 ? toolCalls : void 0\n        });\n        break;\n      }\n      case \"tool\": {\n        for (const toolResponse of content) {\n          const output = toolResponse.output;\n          let contentValue;\n          switch (output.type) {\n            case \"text\":\n            case \"error-text\":\n              contentValue = output.value;\n              break;\n            case \"content\":\n            case \"json\":\n            case \"error-json\":\n              contentValue = JSON.stringify(output.value);\n              break;\n          }\n          messages.push({\n            role: \"tool\",\n            tool_call_id: toolResponse.toolCallId,\n            content: contentValue\n          });\n        }\n        break;\n      }\n      default: {\n        const _exhaustiveCheck = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n  return messages;\n}\n\n// src/responses/ollama-responses-prepare-tools.ts\n\nfunction prepareResponsesTools({\n  tools,\n  toolChoice\n}) {\n  tools = (tools == null ? void 0 : tools.length) ? tools : void 0;\n  const toolWarnings = [];\n  if (tools == null) {\n    return { tools: void 0, toolChoice: void 0, toolWarnings };\n  }\n  const ollamaTools = [];\n  for (const tool of tools) {\n    switch (tool.type) {\n      case \"function\": {\n        let parameters = tool.inputSchema;\n        if (!parameters) {\n          parameters = {\n            type: \"object\",\n            properties: {},\n            required: []\n          };\n        } else if (parameters && typeof parameters === \"object\" && parameters.type === \"object\" && parameters.properties && Object.keys(parameters.properties).length === 0) {\n          parameters = {\n            ...parameters,\n            properties: {},\n            required: []\n          };\n        }\n        ollamaTools.push({\n          type: \"function\",\n          function: {\n            name: tool.name,\n            description: tool.description,\n            parameters\n          }\n        });\n        break;\n      }\n      default:\n        toolWarnings.push({ type: \"unsupported-tool\", tool });\n        break;\n    }\n  }\n  if (toolChoice == null) {\n    return { tools: ollamaTools, toolChoice: void 0, toolWarnings };\n  }\n  const type = toolChoice.type;\n  switch (type) {\n    case \"auto\":\n    case \"none\":\n    case \"required\":\n      return { tools: ollamaTools, toolChoice: type, toolWarnings };\n    case \"tool\":\n      return {\n        tools: ollamaTools,\n        toolChoice: toolChoice.toolName == \"web_search_preview\" ? { type: \"web_search_preview\" } : { type: \"function\", name: toolChoice.toolName },\n        toolWarnings\n      };\n    default: {\n      const _exhaustiveCheck = type;\n      throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.UnsupportedFunctionalityError({\n        functionality: `tool choice type: ${_exhaustiveCheck}`\n      });\n    }\n  }\n}\n\n// src/ollama-chat-settings.ts\n\nvar ollamaProviderOptions = zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n  /**\n   * Enable or disable the model's thinking process. When enabled, the output will separate\n   * the model's thinking from the model's output. When disabled, the model will not think\n   * and directly output the content.\n   *\n   * Only supported by certain models like DeepSeek R1 and Qwen 3.\n   */\n  think: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.boolean().optional(),\n  options: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    num_ctx: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n    repeat_last_n: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n    repeat_penalty: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n    temperature: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n    seed: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n    stop: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string()).optional(),\n    num_predict: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n    top_k: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n    top_p: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n    min_p: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional()\n  }).optional()\n});\n\n// src/responses/ollama-responses-request-builder.ts\nvar OllamaRequestBuilder = class {\n  async buildRequest({\n    modelId,\n    maxOutputTokens,\n    temperature,\n    stopSequences,\n    topP,\n    topK,\n    presencePenalty,\n    frequencyPenalty,\n    seed,\n    prompt,\n    providerOptions,\n    tools,\n    toolChoice,\n    responseFormat\n  }) {\n    const warnings = this.collectUnsupportedSettingsWarnings({\n      topK,\n      seed,\n      presencePenalty,\n      frequencyPenalty,\n      stopSequences\n    });\n    const { messages, warnings: messageWarnings } = convertToOllamaResponsesMessages({\n      prompt,\n      systemMessageMode: \"system\"\n    });\n    warnings.push(...messageWarnings);\n    const ollamaOptions = await this.parseProviderOptions(providerOptions);\n    const baseArgs = this.buildBaseArgs({\n      modelId,\n      prompt,\n      temperature,\n      topP,\n      maxOutputTokens,\n      responseFormat,\n      ollamaOptions\n    });\n    const { tools: ollamaTools, toolChoice: ollamaToolChoice, toolWarnings } = prepareResponsesTools({\n      tools,\n      toolChoice\n    });\n    return {\n      args: {\n        ...baseArgs,\n        tools: ollamaTools,\n        tool_choice: ollamaToolChoice\n      },\n      warnings: [...warnings, ...toolWarnings]\n    };\n  }\n  collectUnsupportedSettingsWarnings({\n    topK,\n    seed,\n    presencePenalty,\n    frequencyPenalty,\n    stopSequences\n  }) {\n    const warnings = [];\n    const unsupportedSettings = [\n      { value: topK, name: \"topK\" },\n      { value: seed, name: \"seed\" },\n      { value: presencePenalty, name: \"presencePenalty\" },\n      { value: frequencyPenalty, name: \"frequencyPenalty\" },\n      { value: stopSequences, name: \"stopSequences\" }\n    ];\n    for (const { value, name } of unsupportedSettings) {\n      if (value != null) {\n        warnings.push({ type: \"unsupported-setting\", setting: name });\n      }\n    }\n    return warnings;\n  }\n  async parseProviderOptions(providerOptions) {\n    const result = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.parseProviderOptions)({\n      provider: \"ollama\",\n      providerOptions,\n      schema: ollamaProviderOptions\n    });\n    return result != null ? result : null;\n  }\n  buildBaseArgs({\n    modelId,\n    prompt,\n    temperature,\n    topP,\n    maxOutputTokens,\n    responseFormat,\n    ollamaOptions\n  }) {\n    var _a, _b;\n    return {\n      model: modelId,\n      messages: convertToOllamaChatMessages({\n        prompt,\n        systemMessageMode: \"system\"\n      }),\n      temperature,\n      top_p: topP,\n      max_output_tokens: maxOutputTokens,\n      ...(responseFormat == null ? void 0 : responseFormat.type) === \"json\" && {\n        format: responseFormat.schema != null ? responseFormat.schema : \"json\"\n      },\n      think: (_a = ollamaOptions == null ? void 0 : ollamaOptions.think) != null ? _a : false,\n      options: (_b = ollamaOptions == null ? void 0 : ollamaOptions.options) != null ? _b : void 0\n    };\n  }\n};\n\n// src/responses/ollama-responses-processor.ts\n\n\nvar baseOllamaResponseSchema2 = zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n  model: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n  created_at: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n  done: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.boolean(),\n  message: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    content: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n    role: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n    thinking: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    tool_calls: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.array(\n      zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n        function: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.object({\n          name: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n          arguments: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.record(zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string(), zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.any())\n        }),\n        id: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string().optional()\n      })\n    ).optional().nullable()\n  }),\n  done_reason: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n  eval_count: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  eval_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  load_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  prompt_eval_count: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  prompt_eval_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional(),\n  total_duration: zod_v4__WEBPACK_IMPORTED_MODULE_0__.z.number().optional()\n});\nvar OllamaResponseProcessor = class {\n  constructor(config) {\n    this.config = config;\n  }\n  processGenerateResponse(response) {\n    const content = this.extractContent(response);\n    const finishReason = mapOllamaFinishReason(response.done_reason);\n    const usage = this.extractUsage(response);\n    const providerMetadata = { ollama: {} };\n    return {\n      content,\n      finishReason,\n      usage,\n      providerMetadata\n    };\n  }\n  extractContent(response) {\n    var _a, _b, _c, _d, _e;\n    const content = [];\n    const text = response.message.content;\n    if (text != null && text.length > 0) {\n      content.push({\n        type: \"text\",\n        text\n      });\n    }\n    const thinking = response.message.thinking;\n    if (thinking != null && thinking.length > 0) {\n      content.push({\n        type: \"reasoning\",\n        text: thinking\n      });\n    }\n    for (const toolCall of (_a = response.message.tool_calls) != null ? _a : []) {\n      content.push({\n        type: \"tool-call\",\n        toolCallId: (_e = toolCall.id) != null ? _e : (_d = (_c = (_b = this.config).generateId) == null ? void 0 : _c.call(_b)) != null ? _d : (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.generateId)(),\n        toolName: toolCall.function.name,\n        input: JSON.stringify(toolCall.function.arguments)\n      });\n    }\n    return content;\n  }\n  extractUsage(response) {\n    var _a, _b, _c, _d;\n    return {\n      inputTokens: (_a = response.prompt_eval_count) != null ? _a : void 0,\n      outputTokens: (_b = response.eval_count) != null ? _b : void 0,\n      totalTokens: ((_c = response.prompt_eval_count) != null ? _c : 0) + ((_d = response.eval_count) != null ? _d : 0),\n      reasoningTokens: void 0,\n      // Ollama doesn't provide separate reasoning tokens\n      cachedInputTokens: void 0\n    };\n  }\n};\nfunction extractOllamaResponseObjectsFromChunk(chunk) {\n  var _a;\n  if (chunk.success) {\n    return [chunk.value];\n  }\n  const results = [];\n  const raw = (_a = chunk.error) == null ? void 0 : _a.text;\n  if (typeof raw !== \"string\" || raw.length === 0) {\n    return results;\n  }\n  const lines = raw.split(/\\r?\\n/);\n  for (const line of lines) {\n    const trimmed = line.trim();\n    if (trimmed === \"\") continue;\n    try {\n      const parsed = JSON.parse(trimmed);\n      const validated = baseOllamaResponseSchema2.safeParse(parsed);\n      if (validated.success) {\n        results.push(validated.data);\n      }\n    } catch (e) {\n    }\n  }\n  return results;\n}\n\n// src/responses/ollama-responses-stream-processor.ts\n\n\nvar OllamaStreamProcessor = class {\n  constructor(config) {\n    this.config = config;\n    this.state = this.initializeState();\n  }\n  createTransformStream(warnings, options) {\n    return new TransformStream({\n      start: (controller) => {\n        controller.enqueue({ type: \"stream-start\", warnings });\n      },\n      transform: (chunk, controller) => {\n        this.processChunk(chunk, controller, options);\n      },\n      flush: (controller) => {\n        this.finalizeStream(controller);\n      }\n    });\n  }\n  initializeState() {\n    return {\n      finishReason: \"unknown\",\n      usage: {\n        inputTokens: void 0,\n        outputTokens: void 0,\n        totalTokens: void 0\n      },\n      responseId: null,\n      ongoingToolCalls: {},\n      hasToolCalls: false,\n      isFirstChunk: true,\n      hasTextStarted: false,\n      hasReasoningStarted: false,\n      textEnded: false,\n      reasoningEnded: false,\n      textId: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.generateId)()\n    };\n  }\n  processChunk(chunk, controller, options) {\n    if (options == null ? void 0 : options.includeRawChunks) {\n      controller.enqueue({ type: \"raw\", rawValue: chunk.rawValue });\n    }\n    const values = extractOllamaResponseObjectsFromChunk(chunk);\n    if (values.length === 0) {\n      if (!chunk.success) {\n        this.state.finishReason = \"error\";\n        controller.enqueue({ type: \"error\", error: chunk.error });\n      }\n      return;\n    }\n    for (const value of values) {\n      this.processResponseValue(value, controller);\n    }\n  }\n  processResponseValue(value, controller) {\n    if (value && typeof value === \"object\" && \"error\" in value) {\n      this.state.finishReason = \"error\";\n      controller.enqueue({ type: \"error\", error: value.error });\n      return;\n    }\n    if (this.state.isFirstChunk) {\n      this.state.isFirstChunk = false;\n      controller.enqueue({\n        type: \"response-metadata\",\n        ...getResponseMetadata(value)\n      });\n    }\n    if (value.done) {\n      this.handleDoneChunk(value, controller);\n    }\n    const delta = value == null ? void 0 : value.message;\n    if (delta) {\n      this.processDelta(delta, controller);\n    }\n  }\n  handleDoneChunk(value, controller) {\n    var _a, _b, _c;\n    this.state.finishReason = mapOllamaFinishReason(value.done_reason);\n    this.state.usage = {\n      inputTokens: value.prompt_eval_count || 0,\n      outputTokens: (_a = value.eval_count) != null ? _a : void 0,\n      totalTokens: ((_b = value.prompt_eval_count) != null ? _b : 0) + ((_c = value.eval_count) != null ? _c : 0)\n    };\n    if (this.state.hasTextStarted && !this.state.textEnded) {\n      controller.enqueue({ type: \"text-end\", id: this.state.textId });\n      this.state.textEnded = true;\n    }\n    if (this.state.hasReasoningStarted && !this.state.reasoningEnded) {\n      controller.enqueue({ type: \"reasoning-end\", id: \"0\" });\n      this.state.reasoningEnded = true;\n    }\n  }\n  processDelta(delta, controller) {\n    this.processTextContent(delta, controller);\n    this.processThinking(delta, controller);\n    this.processToolCalls(delta, controller);\n  }\n  processTextContent(delta, controller) {\n    if ((delta == null ? void 0 : delta.content) != null) {\n      if (!this.state.hasTextStarted) {\n        controller.enqueue({ type: \"text-start\", id: this.state.textId });\n        this.state.hasTextStarted = true;\n      }\n      controller.enqueue({\n        type: \"text-delta\",\n        id: this.state.textId,\n        delta: delta.content\n      });\n    }\n  }\n  processThinking(delta, controller) {\n    if (delta == null ? void 0 : delta.thinking) {\n      if (!this.state.hasReasoningStarted) {\n        controller.enqueue({ type: \"reasoning-start\", id: \"0\" });\n        this.state.hasReasoningStarted = true;\n      }\n      controller.enqueue({\n        type: \"reasoning-delta\",\n        id: \"0\",\n        delta: delta.thinking\n      });\n    }\n  }\n  processToolCalls(delta, controller) {\n    var _a, _b, _c, _d;\n    for (const toolCall of (_a = delta.tool_calls) != null ? _a : []) {\n      if (((_b = toolCall.function) == null ? void 0 : _b.name) == null) {\n        throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.InvalidResponseDataError({\n          data: toolCall,\n          message: `Expected 'function.name' to be a string.`\n        });\n      }\n      if (((_c = toolCall.function) == null ? void 0 : _c.name) != null && ((_d = toolCall.function) == null ? void 0 : _d.arguments) != null) {\n        this.emitToolCall(toolCall, controller);\n      }\n    }\n  }\n  emitToolCall(toolCall, controller) {\n    var _a, _b, _c, _d;\n    const id = (_d = toolCall.id) != null ? _d : (_c = (_b = (_a = this.config).generateId) == null ? void 0 : _b.call(_a)) != null ? _c : (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.generateId)();\n    controller.enqueue({\n      type: \"tool-input-start\",\n      id,\n      toolName: toolCall.function.name\n    });\n    controller.enqueue({\n      type: \"tool-input-delta\",\n      id,\n      delta: JSON.stringify(toolCall.function.arguments)\n    });\n    controller.enqueue({\n      type: \"tool-input-end\",\n      id\n    });\n    controller.enqueue({\n      type: \"tool-call\",\n      toolCallId: id,\n      toolName: toolCall.function.name,\n      input: JSON.stringify(toolCall.function.arguments)\n    });\n    this.state.hasToolCalls = true;\n  }\n  finalizeStream(controller) {\n    if (this.state.hasTextStarted && !this.state.textEnded) {\n      controller.enqueue({ type: \"text-end\", id: \"0\" });\n    }\n    if (this.state.hasReasoningStarted && !this.state.reasoningEnded) {\n      controller.enqueue({ type: \"reasoning-end\", id: \"0\" });\n    }\n    controller.enqueue({\n      type: \"finish\",\n      finishReason: this.state.finishReason,\n      usage: this.state.usage,\n      providerMetadata: {\n        ollama: {\n          responseId: this.state.responseId\n        }\n      }\n    });\n  }\n};\n\n// src/responses/ollama-responses-language-model.ts\nvar OllamaResponsesLanguageModel = class {\n  constructor(modelId, config) {\n    this.specificationVersion = \"v2\";\n    this.supportedUrls = {\n      \"image/*\": [\n        /^https?:\\/\\/.*$/\n      ]\n    };\n    this.modelId = modelId;\n    this.config = config;\n    this.requestBuilder = new OllamaRequestBuilder();\n    this.responseProcessor = new OllamaResponseProcessor(config);\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  async doGenerate(options) {\n    const { args: body, warnings } = await this.prepareRequest(options);\n    const {\n      responseHeaders,\n      value: response,\n      rawValue: rawResponse\n    } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.postJsonToApi)({\n      url: this.config.url({\n        path: \"/chat\",\n        modelId: this.modelId\n      }),\n      headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.combineHeaders)(this.config.headers(), options.headers),\n      body: { ...body, stream: false },\n      failedResponseHandler: ollamaFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonResponseHandler)(baseOllamaResponseSchema2),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch\n    });\n    const processedResponse = this.responseProcessor.processGenerateResponse(response);\n    return {\n      ...processedResponse,\n      request: { body: JSON.stringify(body) },\n      response: {\n        modelId: this.modelId,\n        timestamp: /* @__PURE__ */ new Date(),\n        headers: responseHeaders,\n        body: rawResponse\n      },\n      warnings\n    };\n  }\n  async doStream(options) {\n    const { args: body, warnings } = await this.prepareRequest(options);\n    const { responseHeaders, value: response } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.postJsonToApi)({\n      url: this.config.url({\n        path: \"/chat\",\n        modelId: this.modelId\n      }),\n      headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.combineHeaders)(this.config.headers(), options.headers),\n      body: { ...body, stream: true },\n      failedResponseHandler: ollamaFailedResponseHandler,\n      successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.createJsonStreamResponseHandler)(baseOllamaResponseSchema2),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch\n    });\n    const streamProcessor = new OllamaStreamProcessor(this.config);\n    return {\n      stream: response.pipeThrough(\n        streamProcessor.createTransformStream(warnings, options)\n      ),\n      request: { body },\n      response: { headers: responseHeaders }\n    };\n  }\n  async prepareRequest(options) {\n    return await this.requestBuilder.buildRequest({\n      modelId: this.modelId,\n      ...options\n    });\n  }\n};\n\n// src/ollama-provider.ts\nfunction createOllama(options = {}) {\n  var _a, _b;\n  const baseURL = (_a = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_1__.withoutTrailingSlash)(options.baseURL)) != null ? _a : \"http://127.0.0.1:11434/api\";\n  const providerName = (_b = options.name) != null ? _b : \"ollama\";\n  const getHeaders = () => ({\n    \"Ollama-Organization\": options.organization,\n    \"Ollama-Project\": options.project,\n    ...options.headers\n  });\n  const createCompletionModel = (modelId, settings = {}) => new OllamaCompletionLanguageModel(modelId, settings, {\n    provider: `${providerName}.completion`,\n    url: ({ path }) => `${baseURL}${path}`,\n    headers: getHeaders,\n    fetch: options.fetch\n  });\n  const createEmbeddingModel = (modelId, settings = {}) => new OllamaEmbeddingModel(modelId, settings, {\n    provider: `${providerName}.embedding`,\n    url: ({ path }) => `${baseURL}${path}`,\n    headers: getHeaders,\n    fetch: options.fetch\n  });\n  const createLanguageModel = (modelId) => {\n    if (new.target) {\n      throw new Error(\n        \"The Ollama model function cannot be called with the new keyword.\"\n      );\n    }\n    return createResponsesModel(modelId);\n  };\n  const createResponsesModel = (modelId) => {\n    return new OllamaResponsesLanguageModel(modelId, {\n      provider: `${providerName}.responses`,\n      url: ({ path }) => `${baseURL}${path}`,\n      headers: getHeaders,\n      fetch: options.fetch\n    });\n  };\n  const provider = function(modelId) {\n    return createLanguageModel(modelId);\n  };\n  provider.languageModel = createLanguageModel;\n  provider.chat = createLanguageModel;\n  provider.completion = createCompletionModel;\n  provider.embedding = createEmbeddingModel;\n  provider.textEmbedding = createEmbeddingModel;\n  provider.textEmbeddingModel = createEmbeddingModel;\n  provider.imageModel = (modelId) => {\n    throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_2__.NoSuchModelError({\n      modelId,\n      modelType: \"imageModel\",\n      message: \"Image generation is unsupported with Ollama\"\n    });\n  };\n  return provider;\n}\nvar ollama = createOllama();\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vb2xsYW1hLWFpLXByb3ZpZGVyLXYyQDEuNS40X3pvZEA0LjEuMTIvbm9kZV9tb2R1bGVzL29sbGFtYS1haS1wcm92aWRlci12Mi9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBRzBCO0FBR007O0FBRWhDO0FBT2dDO0FBQ0M7O0FBRWpDO0FBQzJCO0FBQzZDO0FBQ3hFLDRCQUE0Qiw0Q0FBUTtBQUNwQyxTQUFTLDRDQUFRO0FBQ2pCLGFBQWEsNENBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0EsVUFBVSw0Q0FBUTtBQUNsQixXQUFXLHlDQUFLO0FBQ2hCLFVBQVUsMkNBQU8sRUFBRSw0Q0FBUSxJQUFJLDRDQUFRO0FBQ3ZDLEdBQUc7QUFDSCxDQUFDO0FBQ0Qsa0NBQWtDLHNGQUE4QjtBQUNoRTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUkwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0Esa0JBQWtCLGdFQUFrQjtBQUNwQywyREFBMkQsUUFBUTtBQUNuRTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULG1CQUFtQixLQUFLO0FBQ3hCLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMkVBQTZCO0FBQ3JEO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsbUJBQW1CLFVBQVU7QUFDN0IsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwyRUFBNkI7QUFDL0M7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLGlCQUFpQjtBQUM5RDtBQUNBO0FBQ0E7QUFDQSxhQUFh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O0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhEQUFnQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFJRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vanN1cy5saW5rLy4vbm9kZV9tb2R1bGVzLy5wbnBtL29sbGFtYS1haS1wcm92aWRlci12MkAxLjUuNF96b2RANC4xLjEyL25vZGVfbW9kdWxlcy9vbGxhbWEtYWktcHJvdmlkZXItdjIvZGlzdC9pbmRleC5tanM/MDkyOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvb2xsYW1hLXByb3ZpZGVyLnRzXG5pbXBvcnQge1xuICBOb1N1Y2hNb2RlbEVycm9yXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyXCI7XG5pbXBvcnQge1xuICB3aXRob3V0VHJhaWxpbmdTbGFzaFxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xuXG4vLyBzcmMvY29tcGxldGlvbi9vbGxhbWEtY29tcGxldGlvbi1sYW5ndWFnZS1tb2RlbC50c1xuaW1wb3J0IHtcbiAgY29tYmluZUhlYWRlcnMsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIsXG4gIGNyZWF0ZUpzb25TdHJlYW1SZXNwb25zZUhhbmRsZXIsXG4gIHBhcnNlUHJvdmlkZXJPcHRpb25zLFxuICBwb3N0SnNvblRvQXBpXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IGFzIHoyIH0gZnJvbSBcInpvZC92NFwiO1xuXG4vLyBzcmMvY29tcGxldGlvbi9vbGxhbWEtZXJyb3IudHNcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kL3Y0XCI7XG5pbXBvcnQgeyBjcmVhdGVKc29uRXJyb3JSZXNwb25zZUhhbmRsZXIgfSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xudmFyIG9sbGFtYUVycm9yRGF0YVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZXJyb3I6IHoub2JqZWN0KHtcbiAgICBtZXNzYWdlOiB6LnN0cmluZygpLFxuICAgIC8vIFRoZSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIGJlbG93IGlzIGhhbmRsZWQgbG9vc2VseSB0byBzdXBwb3J0XG4gICAgLy8gT2xsYW1hLWNvbXBhdGlibGUgcHJvdmlkZXJzIHRoYXQgaGF2ZSBzbGlnaHRseSBkaWZmZXJlbnQgZXJyb3JcbiAgICAvLyByZXNwb25zZXM6XG4gICAgdHlwZTogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gICAgcGFyYW06IHouYW55KCkubnVsbGlzaCgpLFxuICAgIGNvZGU6IHoudW5pb24oW3ouc3RyaW5nKCksIHoubnVtYmVyKCldKS5udWxsaXNoKClcbiAgfSlcbn0pO1xudmFyIG9sbGFtYUZhaWxlZFJlc3BvbnNlSGFuZGxlciA9IGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlcih7XG4gIGVycm9yU2NoZW1hOiBvbGxhbWFFcnJvckRhdGFTY2hlbWEsXG4gIGVycm9yVG9NZXNzYWdlOiAoZGF0YSkgPT4gZGF0YS5lcnJvci5tZXNzYWdlXG59KTtcblxuLy8gc3JjL2FkYXB0b3JzL2NvbnZlcnQtdG8tb2xsYW1hLWNvbXBsZXRpb24tcHJvbXB0LnRzXG5pbXBvcnQge1xuICBJbnZhbGlkUHJvbXB0RXJyb3IsXG4gIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyXCI7XG5mdW5jdGlvbiBjb252ZXJ0VG9PbGxhbWFDb21wbGV0aW9uUHJvbXB0KHtcbiAgcHJvbXB0LFxuICB1c2VyID0gXCJ1c2VyXCIsXG4gIGFzc2lzdGFudCA9IFwiYXNzaXN0YW50XCJcbn0pIHtcbiAgbGV0IHRleHQgPSBcIlwiO1xuICBpZiAocHJvbXB0WzBdLnJvbGUgPT09IFwic3lzdGVtXCIpIHtcbiAgICB0ZXh0ICs9IGAke3Byb21wdFswXS5jb250ZW50fVxuXG5gO1xuICAgIHByb21wdCA9IHByb21wdC5zbGljZSgxKTtcbiAgfVxuICBmb3IgKGNvbnN0IHsgcm9sZSwgY29udGVudCB9IG9mIHByb21wdCkge1xuICAgIHN3aXRjaCAocm9sZSkge1xuICAgICAgY2FzZSBcInN5c3RlbVwiOiB7XG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkUHJvbXB0RXJyb3Ioe1xuICAgICAgICAgIG1lc3NhZ2U6IFwiVW5leHBlY3RlZCBzeXN0ZW0gbWVzc2FnZSBpbiBwcm9tcHQ6ICR7Y29udGVudH1cIixcbiAgICAgICAgICBwcm9tcHRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjYXNlIFwidXNlclwiOiB7XG4gICAgICAgIGNvbnN0IHVzZXJNZXNzYWdlID0gY29udGVudC5tYXAoKHBhcnQpID0+IHtcbiAgICAgICAgICBzd2l0Y2ggKHBhcnQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcInRleHRcIjoge1xuICAgICAgICAgICAgICByZXR1cm4gcGFydC50ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSkuZmlsdGVyKEJvb2xlYW4pLmpvaW4oXCJcIik7XG4gICAgICAgIHRleHQgKz0gYCR7dXNlcn06XG4ke3VzZXJNZXNzYWdlfVxuXG5gO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJhc3Npc3RhbnRcIjoge1xuICAgICAgICBjb25zdCBhc3Npc3RhbnRNZXNzYWdlID0gY29udGVudC5tYXAoKHBhcnQpID0+IHtcbiAgICAgICAgICBzd2l0Y2ggKHBhcnQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcInRleHRcIjoge1xuICAgICAgICAgICAgICByZXR1cm4gcGFydC50ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcInRvb2wtY2FsbFwiOiB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcih7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb25hbGl0eTogXCJ0b29sLWNhbGwgbWVzc2FnZXNcIlxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pLmpvaW4oXCJcIik7XG4gICAgICAgIHRleHQgKz0gYCR7YXNzaXN0YW50fTpcbiR7YXNzaXN0YW50TWVzc2FnZX1cblxuYDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFwidG9vbFwiOiB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcih7XG4gICAgICAgICAgZnVuY3Rpb25hbGl0eTogXCJ0b29sIG1lc3NhZ2VzXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBkZWZhdWx0OiB7XG4gICAgICAgIGNvbnN0IF9leGhhdXN0aXZlQ2hlY2sgPSByb2xlO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHJvbGU6ICR7X2V4aGF1c3RpdmVDaGVja31gKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgdGV4dCArPSBgJHthc3Npc3RhbnR9OlxuYDtcbiAgcmV0dXJuIHtcbiAgICBwcm9tcHQ6IHRleHQsXG4gICAgc3RvcFNlcXVlbmNlczogW2BcbiR7dXNlcn06YF1cbiAgfTtcbn1cblxuLy8gc3JjL2FkYXB0b3JzL21hcC1vbGxhbWEtZmluaXNoLXJlYXNvbi50c1xuZnVuY3Rpb24gbWFwT2xsYW1hRmluaXNoUmVhc29uKGZpbmlzaFJlYXNvbikge1xuICBzd2l0Y2ggKGZpbmlzaFJlYXNvbikge1xuICAgIGNhc2UgXCJzdG9wXCI6XG4gICAgICByZXR1cm4gXCJzdG9wXCI7XG4gICAgY2FzZSBcImxlbmd0aFwiOlxuICAgICAgcmV0dXJuIFwibGVuZ3RoXCI7XG4gICAgY2FzZSBcImNvbnRlbnRfZmlsdGVyXCI6XG4gICAgICByZXR1cm4gXCJjb250ZW50LWZpbHRlclwiO1xuICAgIGNhc2UgXCJmdW5jdGlvbl9jYWxsXCI6XG4gICAgY2FzZSBcInRvb2xfY2FsbHNcIjpcbiAgICAgIHJldHVybiBcInRvb2wtY2FsbHNcIjtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIFwidW5rbm93blwiO1xuICB9XG59XG5cbi8vIHNyYy9jb21tb24vZ2V0LXJlc3BvbnNlLW1ldGFkYXRhLnRzXG5mdW5jdGlvbiBnZXRSZXNwb25zZU1ldGFkYXRhKHtcbiAgbW9kZWwsXG4gIGNyZWF0ZWRfYXRcbn0pIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogdm9pZCAwLFxuICAgIG1vZGVsSWQ6IG1vZGVsICE9IG51bGwgPyBtb2RlbCA6IHZvaWQgMCxcbiAgICB0aW1lc3RhbXA6IGNyZWF0ZWRfYXQgIT0gbnVsbCA/IG5ldyBEYXRlKGNyZWF0ZWRfYXQpIDogdm9pZCAwXG4gIH07XG59XG5cbi8vIHNyYy9jb21wbGV0aW9uL29sbGFtYS1jb21wbGV0aW9uLWxhbmd1YWdlLW1vZGVsLnRzXG52YXIgb2xsYW1hQ29tcGxldGlvblByb3ZpZGVyT3B0aW9ucyA9IHoyLm9iamVjdCh7XG4gIHRoaW5rOiB6Mi5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgdXNlcjogejIuc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgc3VmZml4OiB6Mi5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBlY2hvOiB6Mi5ib29sZWFuKCkub3B0aW9uYWwoKVxufSk7XG52YXIgT2xsYW1hQ29tcGxldGlvbkxhbmd1YWdlTW9kZWwgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKG1vZGVsSWQsIHNldHRpbmdzLCBjb25maWcpIHtcbiAgICB0aGlzLnNwZWNpZmljYXRpb25WZXJzaW9uID0gXCJ2MlwiO1xuICAgIHRoaXMuc3VwcG9ydGVkVXJscyA9IHtcbiAgICAgIC8vIE5vIFVSTHMgYXJlIHN1cHBvcnRlZCBmb3IgY29tcGxldGlvbiBtb2RlbHMuXG4gICAgfTtcbiAgICB0aGlzLm1vZGVsSWQgPSBtb2RlbElkO1xuICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgfVxuICBnZXQgcHJvdmlkZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLnByb3ZpZGVyO1xuICB9XG4gIGFzeW5jIGdldEFyZ3Moe1xuICAgIHByb21wdCxcbiAgICBtYXhPdXRwdXRUb2tlbnMsXG4gICAgdGVtcGVyYXR1cmUsXG4gICAgdG9wUCxcbiAgICB0b3BLLFxuICAgIGZyZXF1ZW5jeVBlbmFsdHksXG4gICAgcHJlc2VuY2VQZW5hbHR5LFxuICAgIHN0b3BTZXF1ZW5jZXM6IHVzZXJTdG9wU2VxdWVuY2VzLFxuICAgIHJlc3BvbnNlRm9ybWF0LFxuICAgIHRvb2xzLFxuICAgIHRvb2xDaG9pY2UsXG4gICAgc2VlZCxcbiAgICBwcm92aWRlck9wdGlvbnNcbiAgfSkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCB3YXJuaW5ncyA9IFtdO1xuICAgIGNvbnN0IG9sbGFtYU9wdGlvbnMgPSAoX2EgPSBhd2FpdCBwYXJzZVByb3ZpZGVyT3B0aW9ucyh7XG4gICAgICBwcm92aWRlcjogXCJvbGxhbWFcIixcbiAgICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgICAgIHNjaGVtYTogb2xsYW1hQ29tcGxldGlvblByb3ZpZGVyT3B0aW9uc1xuICAgIH0pKSAhPSBudWxsID8gX2EgOiB7fTtcbiAgICBpZiAodG9wSyAhPSBudWxsKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgdHlwZTogXCJ1bnN1cHBvcnRlZC1zZXR0aW5nXCIsXG4gICAgICAgIHNldHRpbmc6IFwidG9wS1wiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHRvb2xzID09IG51bGwgPyB2b2lkIDAgOiB0b29scy5sZW5ndGgpIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goeyB0eXBlOiBcInVuc3VwcG9ydGVkLXNldHRpbmdcIiwgc2V0dGluZzogXCJ0b29sc1wiIH0pO1xuICAgIH1cbiAgICBpZiAodG9vbENob2ljZSAhPSBudWxsKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKHsgdHlwZTogXCJ1bnN1cHBvcnRlZC1zZXR0aW5nXCIsIHNldHRpbmc6IFwidG9vbENob2ljZVwiIH0pO1xuICAgIH1cbiAgICBpZiAocmVzcG9uc2VGb3JtYXQgIT0gbnVsbCAmJiByZXNwb25zZUZvcm1hdC50eXBlICE9PSBcInRleHRcIikge1xuICAgICAgd2FybmluZ3MucHVzaCh7XG4gICAgICAgIHR5cGU6IFwidW5zdXBwb3J0ZWQtc2V0dGluZ1wiLFxuICAgICAgICBzZXR0aW5nOiBcInJlc3BvbnNlRm9ybWF0XCIsXG4gICAgICAgIGRldGFpbHM6IFwiSlNPTiByZXNwb25zZSBmb3JtYXQgaXMgbm90IHN1cHBvcnRlZC5cIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgcHJvbXB0OiBjb21wbGV0aW9uUHJvbXB0LCBzdG9wU2VxdWVuY2VzIH0gPSBjb252ZXJ0VG9PbGxhbWFDb21wbGV0aW9uUHJvbXB0KHsgcHJvbXB0IH0pO1xuICAgIGNvbnN0IHN0b3AgPSBbLi4uc3RvcFNlcXVlbmNlcyAhPSBudWxsID8gc3RvcFNlcXVlbmNlcyA6IFtdLCAuLi51c2VyU3RvcFNlcXVlbmNlcyAhPSBudWxsID8gdXNlclN0b3BTZXF1ZW5jZXMgOiBbXV07XG4gICAgcmV0dXJuIHtcbiAgICAgIGFyZ3M6IHtcbiAgICAgICAgLy8gbW9kZWwgaWQ6XG4gICAgICAgIG1vZGVsOiB0aGlzLm1vZGVsSWQsXG4gICAgICAgIC8vIE9sbGFtYS1zdXBwb3J0ZWQgc2V0dGluZ3M6XG4gICAgICAgIHVzZXI6IG9sbGFtYU9wdGlvbnMudXNlcixcbiAgICAgICAgdGhpbms6IG9sbGFtYU9wdGlvbnMudGhpbmssXG4gICAgICAgIC8vIHN0YW5kYXJkaXplZCBzZXR0aW5nczpcbiAgICAgICAgbWF4X3Rva2VuczogbWF4T3V0cHV0VG9rZW5zLFxuICAgICAgICB0ZW1wZXJhdHVyZSxcbiAgICAgICAgdG9wX3A6IHRvcFAsXG4gICAgICAgIGZyZXF1ZW5jeV9wZW5hbHR5OiBmcmVxdWVuY3lQZW5hbHR5LFxuICAgICAgICBwcmVzZW5jZV9wZW5hbHR5OiBwcmVzZW5jZVBlbmFsdHksXG4gICAgICAgIHN0b3AsXG4gICAgICAgIC8vIHByb21wdDpcbiAgICAgICAgcHJvbXB0OiBjb21wbGV0aW9uUHJvbXB0LFxuICAgICAgICAvLyBvdGhlciBzZXR0aW5nczpcbiAgICAgICAgc3VmZml4OiBvbGxhbWFPcHRpb25zLnN1ZmZpeCxcbiAgICAgICAgZWNobzogb2xsYW1hT3B0aW9ucy5lY2hvLFxuICAgICAgICBzdHJlYW06IGZhbHNlXG4gICAgICAgIC8vIGFsd2F5cyBkaXNhYmxlZCBmb3IgZG9HZW5lcmF0ZVxuICAgICAgfSxcbiAgICAgIHdhcm5pbmdzXG4gICAgfTtcbiAgfVxuICBhc3luYyBkb0dlbmVyYXRlKG9wdGlvbnMpIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgY29uc3QgeyBhcmdzOiBib2R5LCB3YXJuaW5ncyB9ID0gYXdhaXQgdGhpcy5nZXRBcmdzKG9wdGlvbnMpO1xuICAgIGNvbnN0IHtcbiAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgIHZhbHVlOiByZXNwb25zZSxcbiAgICAgIHJhd1ZhbHVlOiByYXdSZXNwb25zZVxuICAgIH0gPSBhd2FpdCBwb3N0SnNvblRvQXBpKHtcbiAgICAgIHVybDogdGhpcy5jb25maWcudXJsKHtcbiAgICAgICAgcGF0aDogXCIvZ2VuZXJhdGVcIixcbiAgICAgICAgbW9kZWxJZDogdGhpcy5tb2RlbElkXG4gICAgICB9KSxcbiAgICAgIGhlYWRlcnM6IGNvbWJpbmVIZWFkZXJzKHRoaXMuY29uZmlnLmhlYWRlcnMoKSwgb3B0aW9ucy5oZWFkZXJzKSxcbiAgICAgIGJvZHk6IHsgLi4uYm9keSwgc3RyZWFtOiBmYWxzZSB9LFxuICAgICAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyOiBvbGxhbWFGYWlsZWRSZXNwb25zZUhhbmRsZXIsXG4gICAgICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyOiBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyKFxuICAgICAgICBiYXNlT2xsYW1hUmVzcG9uc2VTY2hlbWFcbiAgICAgICksXG4gICAgICBhYm9ydFNpZ25hbDogb3B0aW9ucy5hYm9ydFNpZ25hbCxcbiAgICAgIGZldGNoOiB0aGlzLmNvbmZpZy5mZXRjaFxuICAgIH0pO1xuICAgIGNvbnN0IHsgcHJvbXB0OiByYXdQcm9tcHQsIC4uLnJhd1NldHRpbmdzIH0gPSBib2R5O1xuICAgIGNvbnN0IHByb3ZpZGVyTWV0YWRhdGEgPSB7IG9sbGFtYToge30gfTtcbiAgICByZXR1cm4ge1xuICAgICAgY29udGVudDogW1xuICAgICAgICB7XG4gICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgdGV4dDogcmVzcG9uc2UucmVzcG9uc2VcbiAgICAgICAgfVxuICAgICAgXSxcbiAgICAgIHVzYWdlOiB7XG4gICAgICAgIGlucHV0VG9rZW5zOiAoX2EgPSByZXNwb25zZS5wcm9tcHRfZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9hIDogdm9pZCAwLFxuICAgICAgICBvdXRwdXRUb2tlbnM6IChfYiA9IHJlc3BvbnNlLmV2YWxfY291bnQpICE9IG51bGwgPyBfYiA6IHZvaWQgMCxcbiAgICAgICAgdG90YWxUb2tlbnM6ICgoX2MgPSByZXNwb25zZS5wcm9tcHRfZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9jIDogMCkgKyAoKF9kID0gcmVzcG9uc2UuZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9kIDogMClcbiAgICAgIH0sXG4gICAgICBmaW5pc2hSZWFzb246IG1hcE9sbGFtYUZpbmlzaFJlYXNvbihcInN0b3BcIiksXG4gICAgICByZXF1ZXN0OiB7IGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpIH0sXG4gICAgICByZXNwb25zZToge1xuICAgICAgICAuLi5nZXRSZXNwb25zZU1ldGFkYXRhKHJlc3BvbnNlKSxcbiAgICAgICAgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICBib2R5OiByYXdSZXNwb25zZVxuICAgICAgfSxcbiAgICAgIHdhcm5pbmdzLFxuICAgICAgcHJvdmlkZXJNZXRhZGF0YVxuICAgIH07XG4gIH1cbiAgYXN5bmMgZG9TdHJlYW0ob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYXJncywgd2FybmluZ3MgfSA9IGF3YWl0IHRoaXMuZ2V0QXJncyhvcHRpb25zKTtcbiAgICBjb25zdCBib2R5ID0ge1xuICAgICAgLi4uYXJncyxcbiAgICAgIHN0cmVhbTogdHJ1ZVxuICAgIH07XG4gICAgY29uc3QgeyByZXNwb25zZUhlYWRlcnMsIHZhbHVlOiByZXNwb25zZSB9ID0gYXdhaXQgcG9zdEpzb25Ub0FwaSh7XG4gICAgICB1cmw6IHRoaXMuY29uZmlnLnVybCh7XG4gICAgICAgIHBhdGg6IFwiL2dlbmVyYXRlXCIsXG4gICAgICAgIG1vZGVsSWQ6IHRoaXMubW9kZWxJZFxuICAgICAgfSksXG4gICAgICBoZWFkZXJzOiBjb21iaW5lSGVhZGVycyh0aGlzLmNvbmZpZy5oZWFkZXJzKCksIG9wdGlvbnMuaGVhZGVycyksXG4gICAgICBib2R5LFxuICAgICAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyOiBvbGxhbWFGYWlsZWRSZXNwb25zZUhhbmRsZXIsXG4gICAgICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyOiBjcmVhdGVKc29uU3RyZWFtUmVzcG9uc2VIYW5kbGVyKFxuICAgICAgICBiYXNlT2xsYW1hUmVzcG9uc2VTY2hlbWFcbiAgICAgICksXG4gICAgICBhYm9ydFNpZ25hbDogb3B0aW9ucy5hYm9ydFNpZ25hbCxcbiAgICAgIGZldGNoOiB0aGlzLmNvbmZpZy5mZXRjaFxuICAgIH0pO1xuICAgIGNvbnN0IHsgcHJvbXB0OiByYXdQcm9tcHQsIC4uLnJhd1NldHRpbmdzIH0gPSBhcmdzO1xuICAgIGxldCBmaW5pc2hSZWFzb24gPSBcInVua25vd25cIjtcbiAgICBsZXQgdXNhZ2UgPSB7XG4gICAgICBpbnB1dFRva2Vuczogdm9pZCAwLFxuICAgICAgb3V0cHV0VG9rZW5zOiB2b2lkIDAsXG4gICAgICB0b3RhbFRva2Vuczogdm9pZCAwXG4gICAgfTtcbiAgICBsZXQgaXNGaXJzdENodW5rID0gdHJ1ZTtcbiAgICByZXR1cm4ge1xuICAgICAgc3RyZWFtOiByZXNwb25zZS5waXBlVGhyb3VnaChcbiAgICAgICAgbmV3IFRyYW5zZm9ybVN0cmVhbSh7XG4gICAgICAgICAgdHJhbnNmb3JtKGNodW5rLCBjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpZiAoIWNodW5rLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgZmluaXNoUmVhc29uID0gXCJlcnJvclwiO1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiBcImVycm9yXCIsIGVycm9yOiBjaHVuay5lcnJvciB9KTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBjaHVuay52YWx1ZTtcbiAgICAgICAgICAgIGlmIChcImVycm9yXCIgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgZmluaXNoUmVhc29uID0gXCJlcnJvclwiO1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiBcImVycm9yXCIsIGVycm9yOiB2YWx1ZS5lcnJvciB9KTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzRmlyc3RDaHVuaykge1xuICAgICAgICAgICAgICBpc0ZpcnN0Q2h1bmsgPSBmYWxzZTtcbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInJlc3BvbnNlLW1ldGFkYXRhXCIsXG4gICAgICAgICAgICAgICAgLi4uZ2V0UmVzcG9uc2VNZXRhZGF0YSh2YWx1ZSlcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUuZG9uZSkge1xuICAgICAgICAgICAgICBmaW5pc2hSZWFzb24gPSBtYXBPbGxhbWFGaW5pc2hSZWFzb24oXCJzdG9wXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlLnJlc3BvbnNlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInRleHQtZGVsdGFcIixcbiAgICAgICAgICAgICAgICBpZDogXCIwXCIsXG4gICAgICAgICAgICAgICAgZGVsdGE6IHZhbHVlLnJlc3BvbnNlXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmx1c2goY29udHJvbGxlcikge1xuICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgdHlwZTogXCJmaW5pc2hcIixcbiAgICAgICAgICAgICAgZmluaXNoUmVhc29uLFxuICAgICAgICAgICAgICB1c2FnZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIHJlcXVlc3Q6IHsgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSkgfSxcbiAgICAgIHJlc3BvbnNlOiB7IGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycyB9XG4gICAgfTtcbiAgfVxufTtcbnZhciBiYXNlT2xsYW1hUmVzcG9uc2VTY2hlbWEgPSB6Mi5vYmplY3Qoe1xuICBtb2RlbDogejIuc3RyaW5nKCksXG4gIGNyZWF0ZWRfYXQ6IHoyLnN0cmluZygpLFxuICByZXNwb25zZTogejIuc3RyaW5nKCksXG4gIGRvbmU6IHoyLmJvb2xlYW4oKSxcbiAgY29udGV4dDogejIuYXJyYXkoejIubnVtYmVyKCkpLFxuICBldmFsX2NvdW50OiB6Mi5udW1iZXIoKS5vcHRpb25hbCgpLFxuICBldmFsX2R1cmF0aW9uOiB6Mi5udW1iZXIoKS5vcHRpb25hbCgpLFxuICBsb2FkX2R1cmF0aW9uOiB6Mi5udW1iZXIoKS5vcHRpb25hbCgpLFxuICB0b3RhbF9kdXJhdGlvbjogejIubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgcHJvbXB0X2V2YWxfY291bnQ6IHoyLm51bWJlcigpLm9wdGlvbmFsKCksXG4gIHByb21wdF9ldmFsX2R1cmF0aW9uOiB6Mi5udW1iZXIoKS5vcHRpb25hbCgpXG59KTtcblxuLy8gc3JjL2VtYmVkZGluZy9vbGxhbWEtZW1iZWRkaW5nLW1vZGVsLnRzXG5pbXBvcnQge1xuICBUb29NYW55RW1iZWRkaW5nVmFsdWVzRm9yQ2FsbEVycm9yXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyXCI7XG5pbXBvcnQge1xuICBjb21iaW5lSGVhZGVycyBhcyBjb21iaW5lSGVhZGVyczIsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIgYXMgY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcjIsXG4gIHBhcnNlUHJvdmlkZXJPcHRpb25zIGFzIHBhcnNlUHJvdmlkZXJPcHRpb25zMixcbiAgcG9zdEpzb25Ub0FwaSBhcyBwb3N0SnNvblRvQXBpMlxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlci11dGlsc1wiO1xuaW1wb3J0IHsgeiBhcyB6MyB9IGZyb20gXCJ6b2QvdjRcIjtcbnZhciBvbGxhbWFFbWJlZGRpbmdQcm92aWRlck9wdGlvbnMgPSB6My5vYmplY3Qoe1xuICBkaW1lbnNpb25zOiB6My5udW1iZXIoKS5vcHRpb25hbCgpLFxuICB0cnVuY2F0ZTogejMuYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gIGtlZXBBbGl2ZTogejMuc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG52YXIgT2xsYW1hRW1iZWRkaW5nTW9kZWwgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKG1vZGVsSWQsIHNldHRpbmdzLCBjb25maWcpIHtcbiAgICB0aGlzLnNwZWNpZmljYXRpb25WZXJzaW9uID0gXCJ2MlwiO1xuICAgIHRoaXMubW9kZWxJZCA9IG1vZGVsSWQ7XG4gICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICB9XG4gIGdldCBwcm92aWRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWcucHJvdmlkZXI7XG4gIH1cbiAgZ2V0IG1heEVtYmVkZGluZ3NQZXJDYWxsKCkge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gKF9hID0gdGhpcy5zZXR0aW5ncy5tYXhFbWJlZGRpbmdzUGVyQ2FsbCkgIT0gbnVsbCA/IF9hIDogMjA0ODtcbiAgfVxuICBnZXQgc3VwcG9ydHNQYXJhbGxlbENhbGxzKCkge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gKF9hID0gdGhpcy5zZXR0aW5ncy5zdXBwb3J0c1BhcmFsbGVsQ2FsbHMpICE9IG51bGwgPyBfYSA6IHRydWU7XG4gIH1cbiAgYXN5bmMgZ2V0QXJncyh7XG4gICAgdmFsdWVzLFxuICAgIHByb3ZpZGVyT3B0aW9uc1xuICB9KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBvbGxhbWFPcHRpb25zID0gKF9hID0gYXdhaXQgcGFyc2VQcm92aWRlck9wdGlvbnMyKHtcbiAgICAgIHByb3ZpZGVyOiBcIm9sbGFtYVwiLFxuICAgICAgcHJvdmlkZXJPcHRpb25zLFxuICAgICAgc2NoZW1hOiBvbGxhbWFFbWJlZGRpbmdQcm92aWRlck9wdGlvbnNcbiAgICB9KSkgIT0gbnVsbCA/IF9hIDoge307XG4gICAgcmV0dXJuIHtcbiAgICAgIGFyZ3M6IHtcbiAgICAgICAgLy8gbW9kZWwgaWQ6XG4gICAgICAgIG1vZGVsOiB0aGlzLm1vZGVsSWQsXG4gICAgICAgIGlucHV0OiB2YWx1ZXMsXG4gICAgICAgIC8vIGFkdmFuY2VkIHBhcmFtZXRlcnM6XG4gICAgICAgIGRpbWVuc2lvbnM6IChfYiA9IG9sbGFtYU9wdGlvbnMuZGltZW5zaW9ucykgIT0gbnVsbCA/IF9iIDogdGhpcy5zZXR0aW5ncy5kaW1lbnNpb25zLFxuICAgICAgICB0cnVuY2F0ZTogb2xsYW1hT3B0aW9ucy50cnVuY2F0ZSxcbiAgICAgICAga2VlcF9hbGl2ZTogb2xsYW1hT3B0aW9ucy5rZWVwQWxpdmVcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIGFzeW5jIGRvRW1iZWQoe1xuICAgIHZhbHVlcyxcbiAgICBoZWFkZXJzLFxuICAgIGFib3J0U2lnbmFsLFxuICAgIHByb3ZpZGVyT3B0aW9uc1xuICB9KSB7XG4gICAgaWYgKHZhbHVlcy5sZW5ndGggPiB0aGlzLm1heEVtYmVkZGluZ3NQZXJDYWxsKSB7XG4gICAgICB0aHJvdyBuZXcgVG9vTWFueUVtYmVkZGluZ1ZhbHVlc0ZvckNhbGxFcnJvcih7XG4gICAgICAgIHByb3ZpZGVyOiB0aGlzLnByb3ZpZGVyLFxuICAgICAgICBtb2RlbElkOiB0aGlzLm1vZGVsSWQsXG4gICAgICAgIG1heEVtYmVkZGluZ3NQZXJDYWxsOiB0aGlzLm1heEVtYmVkZGluZ3NQZXJDYWxsLFxuICAgICAgICB2YWx1ZXNcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGFyZ3M6IGJvZHkgfSA9IGF3YWl0IHRoaXMuZ2V0QXJncyh7IHZhbHVlcywgcHJvdmlkZXJPcHRpb25zIH0pO1xuICAgIGNvbnN0IHtcbiAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgIHZhbHVlOiByZXNwb25zZSxcbiAgICAgIHJhd1ZhbHVlXG4gICAgfSA9IGF3YWl0IHBvc3RKc29uVG9BcGkyKHtcbiAgICAgIHVybDogdGhpcy5jb25maWcudXJsKHtcbiAgICAgICAgcGF0aDogXCIvZW1iZWRcIixcbiAgICAgICAgbW9kZWxJZDogdGhpcy5tb2RlbElkXG4gICAgICB9KSxcbiAgICAgIGhlYWRlcnM6IGNvbWJpbmVIZWFkZXJzMih0aGlzLmNvbmZpZy5oZWFkZXJzKCksIGhlYWRlcnMpLFxuICAgICAgYm9keTogeyAuLi5ib2R5IH0sXG4gICAgICBmYWlsZWRSZXNwb25zZUhhbmRsZXI6IG9sbGFtYUZhaWxlZFJlc3BvbnNlSGFuZGxlcixcbiAgICAgIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIyKFxuICAgICAgICBvbGxhbWFUZXh0RW1iZWRkaW5nUmVzcG9uc2VTY2hlbWFcbiAgICAgICksXG4gICAgICBhYm9ydFNpZ25hbCxcbiAgICAgIGZldGNoOiB0aGlzLmNvbmZpZy5mZXRjaFxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICBlbWJlZGRpbmdzOiByZXNwb25zZS5lbWJlZGRpbmdzLm1hcCgoaXRlbSkgPT4gaXRlbSksXG4gICAgICB1c2FnZTogeyB0b2tlbnM6IHJlc3BvbnNlLnByb21wdF9ldmFsX2NvdW50IH0sXG4gICAgICByZXNwb25zZTogeyBoZWFkZXJzOiByZXNwb25zZUhlYWRlcnMsIGJvZHk6IHJhd1ZhbHVlIH1cbiAgICB9O1xuICB9XG59O1xudmFyIG9sbGFtYVRleHRFbWJlZGRpbmdSZXNwb25zZVNjaGVtYSA9IHozLm9iamVjdCh7XG4gIG1vZGVsOiB6My5zdHJpbmcoKSxcbiAgZW1iZWRkaW5nczogejMuYXJyYXkoejMuYXJyYXkoejMubnVtYmVyKCkpKSxcbiAgdG90YWxfZHVyYXRpb246IHozLm51bWJlcigpLFxuICBsb2FkX2R1cmF0aW9uOiB6My5udW1iZXIoKSxcbiAgcHJvbXB0X2V2YWxfY291bnQ6IHozLm51bWJlcigpXG59KTtcblxuLy8gc3JjL3Jlc3BvbnNlcy9vbGxhbWEtcmVzcG9uc2VzLWxhbmd1YWdlLW1vZGVsLnRzXG5pbXBvcnQge1xuICBjb21iaW5lSGVhZGVycyBhcyBjb21iaW5lSGVhZGVyczMsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIgYXMgY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcjMsXG4gIGNyZWF0ZUpzb25TdHJlYW1SZXNwb25zZUhhbmRsZXIgYXMgY3JlYXRlSnNvblN0cmVhbVJlc3BvbnNlSGFuZGxlcjIsXG4gIHBvc3RKc29uVG9BcGkgYXMgcG9zdEpzb25Ub0FwaTNcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcblxuLy8gc3JjL3Jlc3BvbnNlcy9vbGxhbWEtcmVzcG9uc2VzLXJlcXVlc3QtYnVpbGRlci50c1xuaW1wb3J0IHsgcGFyc2VQcm92aWRlck9wdGlvbnMgYXMgcGFyc2VQcm92aWRlck9wdGlvbnMzIH0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcblxuLy8gc3JjL3Jlc3BvbnNlcy9jb252ZXJ0LXRvLW9sbGFtYS1yZXNwb25zZXMtbWVzc2FnZXMudHNcbmltcG9ydCB7XG4gIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yIGFzIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yMlxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlclwiO1xuZnVuY3Rpb24gY29udmVydFRvT2xsYW1hUmVzcG9uc2VzTWVzc2FnZXMoe1xuICBwcm9tcHQsXG4gIHN5c3RlbU1lc3NhZ2VNb2RlXG59KSB7XG4gIGNvbnN0IG1lc3NhZ2VzID0gW107XG4gIGNvbnN0IHdhcm5pbmdzID0gW107XG4gIGZvciAoY29uc3QgeyByb2xlLCBjb250ZW50IH0gb2YgcHJvbXB0KSB7XG4gICAgc3dpdGNoIChyb2xlKSB7XG4gICAgICBjYXNlIFwic3lzdGVtXCI6IHtcbiAgICAgICAgc3dpdGNoIChzeXN0ZW1NZXNzYWdlTW9kZSkge1xuICAgICAgICAgIGNhc2UgXCJzeXN0ZW1cIjoge1xuICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6IFwic3lzdGVtXCIsIGNvbnRlbnQgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBcImRldmVsb3BlclwiOiB7XG4gICAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsgcm9sZTogXCJkZXZlbG9wZXJcIiwgY29udGVudCB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goe1xuICAgICAgICAgICAgICB0eXBlOiBcIm90aGVyXCIsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFwic3lzdGVtIG1lc3NhZ2VzIGFyZSByZW1vdmVkIGZvciB0aGlzIG1vZGVsXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgIGNvbnN0IF9leGhhdXN0aXZlQ2hlY2sgPSBzeXN0ZW1NZXNzYWdlTW9kZTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgYFVuc3VwcG9ydGVkIHN5c3RlbSBtZXNzYWdlIG1vZGU6ICR7X2V4aGF1c3RpdmVDaGVja31gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJ1c2VyXCI6IHtcbiAgICAgICAgbWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXG4gICAgICAgICAgY29udGVudDogY29udGVudC5tYXAoKHBhcnQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAgICAgICAgIHN3aXRjaCAocGFydC50eXBlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB0eXBlOiBcImlucHV0X3RleHRcIiwgdGV4dDogcGFydC50ZXh0IH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY2FzZSBcImZpbGVcIjoge1xuICAgICAgICAgICAgICAgIGlmIChwYXJ0Lm1lZGlhVHlwZS5zdGFydHNXaXRoKFwiaW1hZ2UvXCIpKSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBtZWRpYVR5cGUgPSBwYXJ0Lm1lZGlhVHlwZSA9PT0gXCJpbWFnZS8qXCIgPyBcImltYWdlL2pwZWdcIiA6IHBhcnQubWVkaWFUeXBlO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJpbnB1dF9pbWFnZVwiLFxuICAgICAgICAgICAgICAgICAgICBpbWFnZV91cmw6IHBhcnQuZGF0YSBpbnN0YW5jZW9mIFVSTCA/IHBhcnQuZGF0YS50b1N0cmluZygpIDogYGRhdGE6JHttZWRpYVR5cGV9O2Jhc2U2NCwke3BhcnQuZGF0YX1gLFxuICAgICAgICAgICAgICAgICAgICAvLyBPbGxhbWEgc3BlY2lmaWMgZXh0ZW5zaW9uOiBpbWFnZSBkZXRhaWxcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAoX2IgPSAoX2EgPSBwYXJ0LnByb3ZpZGVyT3B0aW9ucykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLm9sbGFtYSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLmltYWdlRGV0YWlsXG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFydC5tZWRpYVR5cGUgPT09IFwiYXBwbGljYXRpb24vcGRmXCIpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChwYXJ0LmRhdGEgaW5zdGFuY2VvZiBVUkwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yMih7XG4gICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25hbGl0eTogXCJQREYgZmlsZSBwYXJ0cyB3aXRoIFVSTHNcIlxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiaW5wdXRfZmlsZVwiLFxuICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTogKF9jID0gcGFydC5maWxlbmFtZSkgIT0gbnVsbCA/IF9jIDogYHBhcnQtJHtpbmRleH0ucGRmYCxcbiAgICAgICAgICAgICAgICAgICAgZmlsZV9kYXRhOiBgZGF0YTphcHBsaWNhdGlvbi9wZGY7YmFzZTY0LCR7cGFydC5kYXRhfWBcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcjIoe1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbmFsaXR5OiBgZmlsZSBwYXJ0IG1lZGlhIHR5cGUgJHtwYXJ0Lm1lZGlhVHlwZX1gXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFwiYXNzaXN0YW50XCI6IHtcbiAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIGNvbnRlbnQpIHtcbiAgICAgICAgICBzd2l0Y2ggKHBhcnQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcInRleHRcIjoge1xuICAgICAgICAgICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFt7IHR5cGU6IFwib3V0cHV0X3RleHRcIiwgdGV4dDogcGFydC50ZXh0IH1dXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJ0b29sLWNhbGxcIjoge1xuICAgICAgICAgICAgICBpZiAocGFydC5wcm92aWRlckV4ZWN1dGVkKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJmdW5jdGlvbl9jYWxsXCIsXG4gICAgICAgICAgICAgICAgY2FsbF9pZDogcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgIG5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOiBKU09OLnN0cmluZ2lmeShwYXJ0LmlucHV0KVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwidG9vbC1yZXN1bHRcIjoge1xuICAgICAgICAgICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm90aGVyXCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYHRvb2wgcmVzdWx0IHBhcnRzIGluIGFzc2lzdGFudCBtZXNzYWdlcyBhcmUgbm90IHN1cHBvcnRlZCBmb3IgT2xsYW1hIHJlc3BvbnNlc2BcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJ0b29sXCI6IHtcbiAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIGNvbnRlbnQpIHtcbiAgICAgICAgICBjb25zdCBvdXRwdXQgPSBwYXJ0Lm91dHB1dDtcbiAgICAgICAgICBsZXQgY29udGVudFZhbHVlO1xuICAgICAgICAgIHN3aXRjaCAob3V0cHV0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgICAgICBjYXNlIFwiZXJyb3ItdGV4dFwiOlxuICAgICAgICAgICAgICBjb250ZW50VmFsdWUgPSBvdXRwdXQudmFsdWU7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImNvbnRlbnRcIjpcbiAgICAgICAgICAgIGNhc2UgXCJqc29uXCI6XG4gICAgICAgICAgICBjYXNlIFwiZXJyb3ItanNvblwiOlxuICAgICAgICAgICAgICBjb250ZW50VmFsdWUgPSBKU09OLnN0cmluZ2lmeShvdXRwdXQudmFsdWUpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiBcImZ1bmN0aW9uX2NhbGxfb3V0cHV0XCIsXG4gICAgICAgICAgICBjYWxsX2lkOiBwYXJ0LnRvb2xDYWxsSWQsXG4gICAgICAgICAgICBvdXRwdXQ6IGNvbnRlbnRWYWx1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICBjb25zdCBfZXhoYXVzdGl2ZUNoZWNrID0gcm9sZTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCByb2xlOiAke19leGhhdXN0aXZlQ2hlY2t9YCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB7IG1lc3NhZ2VzLCB3YXJuaW5ncyB9O1xufVxuXG4vLyBzcmMvYWRhcHRvcnMvY29udmVydC10by1vbGxhbWEtY2hhdC1tZXNzYWdlcy50c1xuZnVuY3Rpb24gY29udmVydFRvT2xsYW1hQ2hhdE1lc3NhZ2VzKHtcbiAgcHJvbXB0LFxuICBzeXN0ZW1NZXNzYWdlTW9kZSA9IFwic3lzdGVtXCJcbn0pIHtcbiAgY29uc3QgbWVzc2FnZXMgPSBbXTtcbiAgZm9yIChjb25zdCB7IHJvbGUsIGNvbnRlbnQgfSBvZiBwcm9tcHQpIHtcbiAgICBzd2l0Y2ggKHJvbGUpIHtcbiAgICAgIGNhc2UgXCJzeXN0ZW1cIjoge1xuICAgICAgICBzd2l0Y2ggKHN5c3RlbU1lc3NhZ2VNb2RlKSB7XG4gICAgICAgICAgY2FzZSBcInN5c3RlbVwiOiB7XG4gICAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudCB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFwiZGV2ZWxvcGVyXCI6IHtcbiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyByb2xlOiBcImRldmVsb3BlclwiLCBjb250ZW50IH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhc2UgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgIGNvbnN0IF9leGhhdXN0aXZlQ2hlY2sgPSBzeXN0ZW1NZXNzYWdlTW9kZTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgYFVuc3VwcG9ydGVkIHN5c3RlbSBtZXNzYWdlIG1vZGU6ICR7X2V4aGF1c3RpdmVDaGVja31gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJ1c2VyXCI6IHtcbiAgICAgICAgaWYgKGNvbnRlbnQubGVuZ3RoID09PSAxICYmIGNvbnRlbnRbMF0udHlwZSA9PT0gXCJ0ZXh0XCIpIHtcbiAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IGNvbnRlbnRbMF0udGV4dCB9KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1c2VyVGV4dCA9IGNvbnRlbnQuZmlsdGVyKChwYXJ0KSA9PiBwYXJ0LnR5cGUgPT09IFwidGV4dFwiKS5tYXAoKHBhcnQpID0+IHBhcnQudGV4dCkuam9pbihcIlwiKTtcbiAgICAgICAgY29uc3QgaW1hZ2VzID0gY29udGVudC5maWx0ZXIoKHBhcnQpID0+IHBhcnQudHlwZSA9PT0gXCJmaWxlXCIgJiYgcGFydC5tZWRpYVR5cGUuc3RhcnRzV2l0aChcImltYWdlL1wiKSkubWFwKChwYXJ0KSA9PiBwYXJ0LmRhdGEpO1xuICAgICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgICBjb250ZW50OiB1c2VyVGV4dC5sZW5ndGggPiAwID8gdXNlclRleHQgOiBbXSxcbiAgICAgICAgICBpbWFnZXM6IGltYWdlcy5sZW5ndGggPiAwID8gaW1hZ2VzIDogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgXCJhc3Npc3RhbnRcIjoge1xuICAgICAgICBsZXQgdGV4dCA9IFwiXCI7XG4gICAgICAgIGxldCB0aGlua2luZyA9IFwiXCI7XG4gICAgICAgIGNvbnN0IHRvb2xDYWxscyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgY29udGVudCkge1xuICAgICAgICAgIHN3aXRjaCAocGFydC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwidGV4dFwiOiB7XG4gICAgICAgICAgICAgIHRleHQgKz0gcGFydC50ZXh0O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJ0b29sLWNhbGxcIjoge1xuICAgICAgICAgICAgICB0b29sQ2FsbHMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IHBhcnQudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICB0eXBlOiBcImZ1bmN0aW9uXCIsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb246IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBhcmd1bWVudHM6IHBhcnQuaW5wdXRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJyZWFzb25pbmdcIjoge1xuICAgICAgICAgICAgICB0aGlua2luZyArPSBwYXJ0LnRleHQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHBhcnQ6ICR7cGFydH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcbiAgICAgICAgICBjb250ZW50OiB0ZXh0LFxuICAgICAgICAgIC4uLnRoaW5raW5nICYmIHsgdGhpbmtpbmcgfSxcbiAgICAgICAgICB0b29sX2NhbGxzOiB0b29sQ2FsbHMubGVuZ3RoID4gMCA/IHRvb2xDYWxscyA6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFwidG9vbFwiOiB7XG4gICAgICAgIGZvciAoY29uc3QgdG9vbFJlc3BvbnNlIG9mIGNvbnRlbnQpIHtcbiAgICAgICAgICBjb25zdCBvdXRwdXQgPSB0b29sUmVzcG9uc2Uub3V0cHV0O1xuICAgICAgICAgIGxldCBjb250ZW50VmFsdWU7XG4gICAgICAgICAgc3dpdGNoIChvdXRwdXQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcInRleHRcIjpcbiAgICAgICAgICAgIGNhc2UgXCJlcnJvci10ZXh0XCI6XG4gICAgICAgICAgICAgIGNvbnRlbnRWYWx1ZSA9IG91dHB1dC52YWx1ZTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY29udGVudFwiOlxuICAgICAgICAgICAgY2FzZSBcImpzb25cIjpcbiAgICAgICAgICAgIGNhc2UgXCJlcnJvci1qc29uXCI6XG4gICAgICAgICAgICAgIGNvbnRlbnRWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KG91dHB1dC52YWx1ZSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgIHJvbGU6IFwidG9vbFwiLFxuICAgICAgICAgICAgdG9vbF9jYWxsX2lkOiB0b29sUmVzcG9uc2UudG9vbENhbGxJZCxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnRWYWx1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICBjb25zdCBfZXhoYXVzdGl2ZUNoZWNrID0gcm9sZTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCByb2xlOiAke19leGhhdXN0aXZlQ2hlY2t9YCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBtZXNzYWdlcztcbn1cblxuLy8gc3JjL3Jlc3BvbnNlcy9vbGxhbWEtcmVzcG9uc2VzLXByZXBhcmUtdG9vbHMudHNcbmltcG9ydCB7XG4gIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yIGFzIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yM1xufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlclwiO1xuZnVuY3Rpb24gcHJlcGFyZVJlc3BvbnNlc1Rvb2xzKHtcbiAgdG9vbHMsXG4gIHRvb2xDaG9pY2Vcbn0pIHtcbiAgdG9vbHMgPSAodG9vbHMgPT0gbnVsbCA/IHZvaWQgMCA6IHRvb2xzLmxlbmd0aCkgPyB0b29scyA6IHZvaWQgMDtcbiAgY29uc3QgdG9vbFdhcm5pbmdzID0gW107XG4gIGlmICh0b29scyA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHsgdG9vbHM6IHZvaWQgMCwgdG9vbENob2ljZTogdm9pZCAwLCB0b29sV2FybmluZ3MgfTtcbiAgfVxuICBjb25zdCBvbGxhbWFUb29scyA9IFtdO1xuICBmb3IgKGNvbnN0IHRvb2wgb2YgdG9vbHMpIHtcbiAgICBzd2l0Y2ggKHRvb2wudHlwZSkge1xuICAgICAgY2FzZSBcImZ1bmN0aW9uXCI6IHtcbiAgICAgICAgbGV0IHBhcmFtZXRlcnMgPSB0b29sLmlucHV0U2NoZW1hO1xuICAgICAgICBpZiAoIXBhcmFtZXRlcnMpIHtcbiAgICAgICAgICBwYXJhbWV0ZXJzID0ge1xuICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgICAgICAgcmVxdWlyZWQ6IFtdXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIGlmIChwYXJhbWV0ZXJzICYmIHR5cGVvZiBwYXJhbWV0ZXJzID09PSBcIm9iamVjdFwiICYmIHBhcmFtZXRlcnMudHlwZSA9PT0gXCJvYmplY3RcIiAmJiBwYXJhbWV0ZXJzLnByb3BlcnRpZXMgJiYgT2JqZWN0LmtleXMocGFyYW1ldGVycy5wcm9wZXJ0aWVzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICBwYXJhbWV0ZXJzID0ge1xuICAgICAgICAgICAgLi4ucGFyYW1ldGVycyxcbiAgICAgICAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgICAgICAgcmVxdWlyZWQ6IFtdXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBvbGxhbWFUb29scy5wdXNoKHtcbiAgICAgICAgICB0eXBlOiBcImZ1bmN0aW9uXCIsXG4gICAgICAgICAgZnVuY3Rpb246IHtcbiAgICAgICAgICAgIG5hbWU6IHRvb2wubmFtZSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0b29sLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgcGFyYW1ldGVyc1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdG9vbFdhcm5pbmdzLnB1c2goeyB0eXBlOiBcInVuc3VwcG9ydGVkLXRvb2xcIiwgdG9vbCB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIGlmICh0b29sQ2hvaWNlID09IG51bGwpIHtcbiAgICByZXR1cm4geyB0b29sczogb2xsYW1hVG9vbHMsIHRvb2xDaG9pY2U6IHZvaWQgMCwgdG9vbFdhcm5pbmdzIH07XG4gIH1cbiAgY29uc3QgdHlwZSA9IHRvb2xDaG9pY2UudHlwZTtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSBcImF1dG9cIjpcbiAgICBjYXNlIFwibm9uZVwiOlxuICAgIGNhc2UgXCJyZXF1aXJlZFwiOlxuICAgICAgcmV0dXJuIHsgdG9vbHM6IG9sbGFtYVRvb2xzLCB0b29sQ2hvaWNlOiB0eXBlLCB0b29sV2FybmluZ3MgfTtcbiAgICBjYXNlIFwidG9vbFwiOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG9vbHM6IG9sbGFtYVRvb2xzLFxuICAgICAgICB0b29sQ2hvaWNlOiB0b29sQ2hvaWNlLnRvb2xOYW1lID09IFwid2ViX3NlYXJjaF9wcmV2aWV3XCIgPyB7IHR5cGU6IFwid2ViX3NlYXJjaF9wcmV2aWV3XCIgfSA6IHsgdHlwZTogXCJmdW5jdGlvblwiLCBuYW1lOiB0b29sQ2hvaWNlLnRvb2xOYW1lIH0sXG4gICAgICAgIHRvb2xXYXJuaW5nc1xuICAgICAgfTtcbiAgICBkZWZhdWx0OiB7XG4gICAgICBjb25zdCBfZXhoYXVzdGl2ZUNoZWNrID0gdHlwZTtcbiAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcjMoe1xuICAgICAgICBmdW5jdGlvbmFsaXR5OiBgdG9vbCBjaG9pY2UgdHlwZTogJHtfZXhoYXVzdGl2ZUNoZWNrfWBcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG4vLyBzcmMvb2xsYW1hLWNoYXQtc2V0dGluZ3MudHNcbmltcG9ydCB7IHogYXMgejQgfSBmcm9tIFwiem9kL3Y0XCI7XG52YXIgb2xsYW1hUHJvdmlkZXJPcHRpb25zID0gejQub2JqZWN0KHtcbiAgLyoqXG4gICAqIEVuYWJsZSBvciBkaXNhYmxlIHRoZSBtb2RlbCdzIHRoaW5raW5nIHByb2Nlc3MuIFdoZW4gZW5hYmxlZCwgdGhlIG91dHB1dCB3aWxsIHNlcGFyYXRlXG4gICAqIHRoZSBtb2RlbCdzIHRoaW5raW5nIGZyb20gdGhlIG1vZGVsJ3Mgb3V0cHV0LiBXaGVuIGRpc2FibGVkLCB0aGUgbW9kZWwgd2lsbCBub3QgdGhpbmtcbiAgICogYW5kIGRpcmVjdGx5IG91dHB1dCB0aGUgY29udGVudC5cbiAgICpcbiAgICogT25seSBzdXBwb3J0ZWQgYnkgY2VydGFpbiBtb2RlbHMgbGlrZSBEZWVwU2VlayBSMSBhbmQgUXdlbiAzLlxuICAgKi9cbiAgdGhpbms6IHo0LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuICBvcHRpb25zOiB6NC5vYmplY3Qoe1xuICAgIG51bV9jdHg6IHo0Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gICAgcmVwZWF0X2xhc3RfbjogejQubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgICByZXBlYXRfcGVuYWx0eTogejQubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgICB0ZW1wZXJhdHVyZTogejQubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgICBzZWVkOiB6NC5udW1iZXIoKS5vcHRpb25hbCgpLFxuICAgIHN0b3A6IHo0LmFycmF5KHo0LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgIG51bV9wcmVkaWN0OiB6NC5udW1iZXIoKS5vcHRpb25hbCgpLFxuICAgIHRvcF9rOiB6NC5udW1iZXIoKS5vcHRpb25hbCgpLFxuICAgIHRvcF9wOiB6NC5udW1iZXIoKS5vcHRpb25hbCgpLFxuICAgIG1pbl9wOiB6NC5udW1iZXIoKS5vcHRpb25hbCgpXG4gIH0pLm9wdGlvbmFsKClcbn0pO1xuXG4vLyBzcmMvcmVzcG9uc2VzL29sbGFtYS1yZXNwb25zZXMtcmVxdWVzdC1idWlsZGVyLnRzXG52YXIgT2xsYW1hUmVxdWVzdEJ1aWxkZXIgPSBjbGFzcyB7XG4gIGFzeW5jIGJ1aWxkUmVxdWVzdCh7XG4gICAgbW9kZWxJZCxcbiAgICBtYXhPdXRwdXRUb2tlbnMsXG4gICAgdGVtcGVyYXR1cmUsXG4gICAgc3RvcFNlcXVlbmNlcyxcbiAgICB0b3BQLFxuICAgIHRvcEssXG4gICAgcHJlc2VuY2VQZW5hbHR5LFxuICAgIGZyZXF1ZW5jeVBlbmFsdHksXG4gICAgc2VlZCxcbiAgICBwcm9tcHQsXG4gICAgcHJvdmlkZXJPcHRpb25zLFxuICAgIHRvb2xzLFxuICAgIHRvb2xDaG9pY2UsXG4gICAgcmVzcG9uc2VGb3JtYXRcbiAgfSkge1xuICAgIGNvbnN0IHdhcm5pbmdzID0gdGhpcy5jb2xsZWN0VW5zdXBwb3J0ZWRTZXR0aW5nc1dhcm5pbmdzKHtcbiAgICAgIHRvcEssXG4gICAgICBzZWVkLFxuICAgICAgcHJlc2VuY2VQZW5hbHR5LFxuICAgICAgZnJlcXVlbmN5UGVuYWx0eSxcbiAgICAgIHN0b3BTZXF1ZW5jZXNcbiAgICB9KTtcbiAgICBjb25zdCB7IG1lc3NhZ2VzLCB3YXJuaW5nczogbWVzc2FnZVdhcm5pbmdzIH0gPSBjb252ZXJ0VG9PbGxhbWFSZXNwb25zZXNNZXNzYWdlcyh7XG4gICAgICBwcm9tcHQsXG4gICAgICBzeXN0ZW1NZXNzYWdlTW9kZTogXCJzeXN0ZW1cIlxuICAgIH0pO1xuICAgIHdhcm5pbmdzLnB1c2goLi4ubWVzc2FnZVdhcm5pbmdzKTtcbiAgICBjb25zdCBvbGxhbWFPcHRpb25zID0gYXdhaXQgdGhpcy5wYXJzZVByb3ZpZGVyT3B0aW9ucyhwcm92aWRlck9wdGlvbnMpO1xuICAgIGNvbnN0IGJhc2VBcmdzID0gdGhpcy5idWlsZEJhc2VBcmdzKHtcbiAgICAgIG1vZGVsSWQsXG4gICAgICBwcm9tcHQsXG4gICAgICB0ZW1wZXJhdHVyZSxcbiAgICAgIHRvcFAsXG4gICAgICBtYXhPdXRwdXRUb2tlbnMsXG4gICAgICByZXNwb25zZUZvcm1hdCxcbiAgICAgIG9sbGFtYU9wdGlvbnNcbiAgICB9KTtcbiAgICBjb25zdCB7IHRvb2xzOiBvbGxhbWFUb29scywgdG9vbENob2ljZTogb2xsYW1hVG9vbENob2ljZSwgdG9vbFdhcm5pbmdzIH0gPSBwcmVwYXJlUmVzcG9uc2VzVG9vbHMoe1xuICAgICAgdG9vbHMsXG4gICAgICB0b29sQ2hvaWNlXG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFyZ3M6IHtcbiAgICAgICAgLi4uYmFzZUFyZ3MsXG4gICAgICAgIHRvb2xzOiBvbGxhbWFUb29scyxcbiAgICAgICAgdG9vbF9jaG9pY2U6IG9sbGFtYVRvb2xDaG9pY2VcbiAgICAgIH0sXG4gICAgICB3YXJuaW5nczogWy4uLndhcm5pbmdzLCAuLi50b29sV2FybmluZ3NdXG4gICAgfTtcbiAgfVxuICBjb2xsZWN0VW5zdXBwb3J0ZWRTZXR0aW5nc1dhcm5pbmdzKHtcbiAgICB0b3BLLFxuICAgIHNlZWQsXG4gICAgcHJlc2VuY2VQZW5hbHR5LFxuICAgIGZyZXF1ZW5jeVBlbmFsdHksXG4gICAgc3RvcFNlcXVlbmNlc1xuICB9KSB7XG4gICAgY29uc3Qgd2FybmluZ3MgPSBbXTtcbiAgICBjb25zdCB1bnN1cHBvcnRlZFNldHRpbmdzID0gW1xuICAgICAgeyB2YWx1ZTogdG9wSywgbmFtZTogXCJ0b3BLXCIgfSxcbiAgICAgIHsgdmFsdWU6IHNlZWQsIG5hbWU6IFwic2VlZFwiIH0sXG4gICAgICB7IHZhbHVlOiBwcmVzZW5jZVBlbmFsdHksIG5hbWU6IFwicHJlc2VuY2VQZW5hbHR5XCIgfSxcbiAgICAgIHsgdmFsdWU6IGZyZXF1ZW5jeVBlbmFsdHksIG5hbWU6IFwiZnJlcXVlbmN5UGVuYWx0eVwiIH0sXG4gICAgICB7IHZhbHVlOiBzdG9wU2VxdWVuY2VzLCBuYW1lOiBcInN0b3BTZXF1ZW5jZXNcIiB9XG4gICAgXTtcbiAgICBmb3IgKGNvbnN0IHsgdmFsdWUsIG5hbWUgfSBvZiB1bnN1cHBvcnRlZFNldHRpbmdzKSB7XG4gICAgICBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICB3YXJuaW5ncy5wdXNoKHsgdHlwZTogXCJ1bnN1cHBvcnRlZC1zZXR0aW5nXCIsIHNldHRpbmc6IG5hbWUgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB3YXJuaW5ncztcbiAgfVxuICBhc3luYyBwYXJzZVByb3ZpZGVyT3B0aW9ucyhwcm92aWRlck9wdGlvbnMpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwYXJzZVByb3ZpZGVyT3B0aW9uczMoe1xuICAgICAgcHJvdmlkZXI6IFwib2xsYW1hXCIsXG4gICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICBzY2hlbWE6IG9sbGFtYVByb3ZpZGVyT3B0aW9uc1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQgIT0gbnVsbCA/IHJlc3VsdCA6IG51bGw7XG4gIH1cbiAgYnVpbGRCYXNlQXJncyh7XG4gICAgbW9kZWxJZCxcbiAgICBwcm9tcHQsXG4gICAgdGVtcGVyYXR1cmUsXG4gICAgdG9wUCxcbiAgICBtYXhPdXRwdXRUb2tlbnMsXG4gICAgcmVzcG9uc2VGb3JtYXQsXG4gICAgb2xsYW1hT3B0aW9uc1xuICB9KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICByZXR1cm4ge1xuICAgICAgbW9kZWw6IG1vZGVsSWQsXG4gICAgICBtZXNzYWdlczogY29udmVydFRvT2xsYW1hQ2hhdE1lc3NhZ2VzKHtcbiAgICAgICAgcHJvbXB0LFxuICAgICAgICBzeXN0ZW1NZXNzYWdlTW9kZTogXCJzeXN0ZW1cIlxuICAgICAgfSksXG4gICAgICB0ZW1wZXJhdHVyZSxcbiAgICAgIHRvcF9wOiB0b3BQLFxuICAgICAgbWF4X291dHB1dF90b2tlbnM6IG1heE91dHB1dFRva2VucyxcbiAgICAgIC4uLihyZXNwb25zZUZvcm1hdCA9PSBudWxsID8gdm9pZCAwIDogcmVzcG9uc2VGb3JtYXQudHlwZSkgPT09IFwianNvblwiICYmIHtcbiAgICAgICAgZm9ybWF0OiByZXNwb25zZUZvcm1hdC5zY2hlbWEgIT0gbnVsbCA/IHJlc3BvbnNlRm9ybWF0LnNjaGVtYSA6IFwianNvblwiXG4gICAgICB9LFxuICAgICAgdGhpbms6IChfYSA9IG9sbGFtYU9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9sbGFtYU9wdGlvbnMudGhpbmspICE9IG51bGwgPyBfYSA6IGZhbHNlLFxuICAgICAgb3B0aW9uczogKF9iID0gb2xsYW1hT3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb2xsYW1hT3B0aW9ucy5vcHRpb25zKSAhPSBudWxsID8gX2IgOiB2b2lkIDBcbiAgICB9O1xuICB9XG59O1xuXG4vLyBzcmMvcmVzcG9uc2VzL29sbGFtYS1yZXNwb25zZXMtcHJvY2Vzc29yLnRzXG5pbXBvcnQgeyBnZW5lcmF0ZUlkIGFzIGdlbmVyYXRlSWQyIH0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcbmltcG9ydCB7IHogYXMgejUgfSBmcm9tIFwiem9kL3Y0XCI7XG52YXIgYmFzZU9sbGFtYVJlc3BvbnNlU2NoZW1hMiA9IHo1Lm9iamVjdCh7XG4gIG1vZGVsOiB6NS5zdHJpbmcoKSxcbiAgY3JlYXRlZF9hdDogejUuc3RyaW5nKCksXG4gIGRvbmU6IHo1LmJvb2xlYW4oKSxcbiAgbWVzc2FnZTogejUub2JqZWN0KHtcbiAgICBjb250ZW50OiB6NS5zdHJpbmcoKSxcbiAgICByb2xlOiB6NS5zdHJpbmcoKSxcbiAgICB0aGlua2luZzogejUuc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICB0b29sX2NhbGxzOiB6NS5hcnJheShcbiAgICAgIHo1Lm9iamVjdCh7XG4gICAgICAgIGZ1bmN0aW9uOiB6NS5vYmplY3Qoe1xuICAgICAgICAgIG5hbWU6IHo1LnN0cmluZygpLFxuICAgICAgICAgIGFyZ3VtZW50czogejUucmVjb3JkKHo1LnN0cmluZygpLCB6NS5hbnkoKSlcbiAgICAgICAgfSksXG4gICAgICAgIGlkOiB6NS5zdHJpbmcoKS5vcHRpb25hbCgpXG4gICAgICB9KVxuICAgICkub3B0aW9uYWwoKS5udWxsYWJsZSgpXG4gIH0pLFxuICBkb25lX3JlYXNvbjogejUuc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZXZhbF9jb3VudDogejUubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgZXZhbF9kdXJhdGlvbjogejUubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgbG9hZF9kdXJhdGlvbjogejUubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgcHJvbXB0X2V2YWxfY291bnQ6IHo1Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gIHByb21wdF9ldmFsX2R1cmF0aW9uOiB6NS5udW1iZXIoKS5vcHRpb25hbCgpLFxuICB0b3RhbF9kdXJhdGlvbjogejUubnVtYmVyKCkub3B0aW9uYWwoKVxufSk7XG52YXIgT2xsYW1hUmVzcG9uc2VQcm9jZXNzb3IgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICB9XG4gIHByb2Nlc3NHZW5lcmF0ZVJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gICAgY29uc3QgY29udGVudCA9IHRoaXMuZXh0cmFjdENvbnRlbnQocmVzcG9uc2UpO1xuICAgIGNvbnN0IGZpbmlzaFJlYXNvbiA9IG1hcE9sbGFtYUZpbmlzaFJlYXNvbihyZXNwb25zZS5kb25lX3JlYXNvbik7XG4gICAgY29uc3QgdXNhZ2UgPSB0aGlzLmV4dHJhY3RVc2FnZShyZXNwb25zZSk7XG4gICAgY29uc3QgcHJvdmlkZXJNZXRhZGF0YSA9IHsgb2xsYW1hOiB7fSB9O1xuICAgIHJldHVybiB7XG4gICAgICBjb250ZW50LFxuICAgICAgZmluaXNoUmVhc29uLFxuICAgICAgdXNhZ2UsXG4gICAgICBwcm92aWRlck1ldGFkYXRhXG4gICAgfTtcbiAgfVxuICBleHRyYWN0Q29udGVudChyZXNwb25zZSkge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2U7XG4gICAgY29uc3QgY29udGVudCA9IFtdO1xuICAgIGNvbnN0IHRleHQgPSByZXNwb25zZS5tZXNzYWdlLmNvbnRlbnQ7XG4gICAgaWYgKHRleHQgIT0gbnVsbCAmJiB0ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnRlbnQucHVzaCh7XG4gICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICB0ZXh0XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdGhpbmtpbmcgPSByZXNwb25zZS5tZXNzYWdlLnRoaW5raW5nO1xuICAgIGlmICh0aGlua2luZyAhPSBudWxsICYmIHRoaW5raW5nLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnRlbnQucHVzaCh7XG4gICAgICAgIHR5cGU6IFwicmVhc29uaW5nXCIsXG4gICAgICAgIHRleHQ6IHRoaW5raW5nXG4gICAgICB9KTtcbiAgICB9XG4gICAgZm9yIChjb25zdCB0b29sQ2FsbCBvZiAoX2EgPSByZXNwb25zZS5tZXNzYWdlLnRvb2xfY2FsbHMpICE9IG51bGwgPyBfYSA6IFtdKSB7XG4gICAgICBjb250ZW50LnB1c2goe1xuICAgICAgICB0eXBlOiBcInRvb2wtY2FsbFwiLFxuICAgICAgICB0b29sQ2FsbElkOiAoX2UgPSB0b29sQ2FsbC5pZCkgIT0gbnVsbCA/IF9lIDogKF9kID0gKF9jID0gKF9iID0gdGhpcy5jb25maWcpLmdlbmVyYXRlSWQpID09IG51bGwgPyB2b2lkIDAgOiBfYy5jYWxsKF9iKSkgIT0gbnVsbCA/IF9kIDogZ2VuZXJhdGVJZDIoKSxcbiAgICAgICAgdG9vbE5hbWU6IHRvb2xDYWxsLmZ1bmN0aW9uLm5hbWUsXG4gICAgICAgIGlucHV0OiBKU09OLnN0cmluZ2lmeSh0b29sQ2FsbC5mdW5jdGlvbi5hcmd1bWVudHMpXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH1cbiAgZXh0cmFjdFVzYWdlKHJlc3BvbnNlKSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICAgIHJldHVybiB7XG4gICAgICBpbnB1dFRva2VuczogKF9hID0gcmVzcG9uc2UucHJvbXB0X2V2YWxfY291bnQpICE9IG51bGwgPyBfYSA6IHZvaWQgMCxcbiAgICAgIG91dHB1dFRva2VuczogKF9iID0gcmVzcG9uc2UuZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9iIDogdm9pZCAwLFxuICAgICAgdG90YWxUb2tlbnM6ICgoX2MgPSByZXNwb25zZS5wcm9tcHRfZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9jIDogMCkgKyAoKF9kID0gcmVzcG9uc2UuZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9kIDogMCksXG4gICAgICByZWFzb25pbmdUb2tlbnM6IHZvaWQgMCxcbiAgICAgIC8vIE9sbGFtYSBkb2Vzbid0IHByb3ZpZGUgc2VwYXJhdGUgcmVhc29uaW5nIHRva2Vuc1xuICAgICAgY2FjaGVkSW5wdXRUb2tlbnM6IHZvaWQgMFxuICAgIH07XG4gIH1cbn07XG5mdW5jdGlvbiBleHRyYWN0T2xsYW1hUmVzcG9uc2VPYmplY3RzRnJvbUNodW5rKGNodW5rKSB7XG4gIHZhciBfYTtcbiAgaWYgKGNodW5rLnN1Y2Nlc3MpIHtcbiAgICByZXR1cm4gW2NodW5rLnZhbHVlXTtcbiAgfVxuICBjb25zdCByZXN1bHRzID0gW107XG4gIGNvbnN0IHJhdyA9IChfYSA9IGNodW5rLmVycm9yKSA9PSBudWxsID8gdm9pZCAwIDogX2EudGV4dDtcbiAgaWYgKHR5cGVvZiByYXcgIT09IFwic3RyaW5nXCIgfHwgcmF3Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG4gIGNvbnN0IGxpbmVzID0gcmF3LnNwbGl0KC9cXHI/XFxuLyk7XG4gIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgIGNvbnN0IHRyaW1tZWQgPSBsaW5lLnRyaW0oKTtcbiAgICBpZiAodHJpbW1lZCA9PT0gXCJcIikgY29udGludWU7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UodHJpbW1lZCk7XG4gICAgICBjb25zdCB2YWxpZGF0ZWQgPSBiYXNlT2xsYW1hUmVzcG9uc2VTY2hlbWEyLnNhZmVQYXJzZShwYXJzZWQpO1xuICAgICAgaWYgKHZhbGlkYXRlZC5zdWNjZXNzKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaCh2YWxpZGF0ZWQuZGF0YSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cztcbn1cblxuLy8gc3JjL3Jlc3BvbnNlcy9vbGxhbWEtcmVzcG9uc2VzLXN0cmVhbS1wcm9jZXNzb3IudHNcbmltcG9ydCB7XG4gIEludmFsaWRSZXNwb25zZURhdGFFcnJvclxufSBmcm9tIFwiQGFpLXNkay9wcm92aWRlclwiO1xuaW1wb3J0IHsgZ2VuZXJhdGVJZCBhcyBnZW5lcmF0ZUlkMyB9IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG52YXIgT2xsYW1hU3RyZWFtUHJvY2Vzc29yID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLnN0YXRlID0gdGhpcy5pbml0aWFsaXplU3RhdGUoKTtcbiAgfVxuICBjcmVhdGVUcmFuc2Zvcm1TdHJlYW0od2FybmluZ3MsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IFRyYW5zZm9ybVN0cmVhbSh7XG4gICAgICBzdGFydDogKGNvbnRyb2xsZXIpID0+IHtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogXCJzdHJlYW0tc3RhcnRcIiwgd2FybmluZ3MgfSk7XG4gICAgICB9LFxuICAgICAgdHJhbnNmb3JtOiAoY2h1bmssIGNvbnRyb2xsZXIpID0+IHtcbiAgICAgICAgdGhpcy5wcm9jZXNzQ2h1bmsoY2h1bmssIGNvbnRyb2xsZXIsIG9wdGlvbnMpO1xuICAgICAgfSxcbiAgICAgIGZsdXNoOiAoY29udHJvbGxlcikgPT4ge1xuICAgICAgICB0aGlzLmZpbmFsaXplU3RyZWFtKGNvbnRyb2xsZXIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGluaXRpYWxpemVTdGF0ZSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZmluaXNoUmVhc29uOiBcInVua25vd25cIixcbiAgICAgIHVzYWdlOiB7XG4gICAgICAgIGlucHV0VG9rZW5zOiB2b2lkIDAsXG4gICAgICAgIG91dHB1dFRva2Vuczogdm9pZCAwLFxuICAgICAgICB0b3RhbFRva2Vuczogdm9pZCAwXG4gICAgICB9LFxuICAgICAgcmVzcG9uc2VJZDogbnVsbCxcbiAgICAgIG9uZ29pbmdUb29sQ2FsbHM6IHt9LFxuICAgICAgaGFzVG9vbENhbGxzOiBmYWxzZSxcbiAgICAgIGlzRmlyc3RDaHVuazogdHJ1ZSxcbiAgICAgIGhhc1RleHRTdGFydGVkOiBmYWxzZSxcbiAgICAgIGhhc1JlYXNvbmluZ1N0YXJ0ZWQ6IGZhbHNlLFxuICAgICAgdGV4dEVuZGVkOiBmYWxzZSxcbiAgICAgIHJlYXNvbmluZ0VuZGVkOiBmYWxzZSxcbiAgICAgIHRleHRJZDogZ2VuZXJhdGVJZDMoKVxuICAgIH07XG4gIH1cbiAgcHJvY2Vzc0NodW5rKGNodW5rLCBjb250cm9sbGVyLCBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMgPT0gbnVsbCA/IHZvaWQgMCA6IG9wdGlvbnMuaW5jbHVkZVJhd0NodW5rcykge1xuICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogXCJyYXdcIiwgcmF3VmFsdWU6IGNodW5rLnJhd1ZhbHVlIH0pO1xuICAgIH1cbiAgICBjb25zdCB2YWx1ZXMgPSBleHRyYWN0T2xsYW1hUmVzcG9uc2VPYmplY3RzRnJvbUNodW5rKGNodW5rKTtcbiAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgaWYgKCFjaHVuay5zdWNjZXNzKSB7XG4gICAgICAgIHRoaXMuc3RhdGUuZmluaXNoUmVhc29uID0gXCJlcnJvclwiO1xuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiBcImVycm9yXCIsIGVycm9yOiBjaHVuay5lcnJvciB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yIChjb25zdCB2YWx1ZSBvZiB2YWx1ZXMpIHtcbiAgICAgIHRoaXMucHJvY2Vzc1Jlc3BvbnNlVmFsdWUodmFsdWUsIGNvbnRyb2xsZXIpO1xuICAgIH1cbiAgfVxuICBwcm9jZXNzUmVzcG9uc2VWYWx1ZSh2YWx1ZSwgY29udHJvbGxlcikge1xuICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgXCJlcnJvclwiIGluIHZhbHVlKSB7XG4gICAgICB0aGlzLnN0YXRlLmZpbmlzaFJlYXNvbiA9IFwiZXJyb3JcIjtcbiAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6IFwiZXJyb3JcIiwgZXJyb3I6IHZhbHVlLmVycm9yIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy5zdGF0ZS5pc0ZpcnN0Q2h1bmspIHtcbiAgICAgIHRoaXMuc3RhdGUuaXNGaXJzdENodW5rID0gZmFsc2U7XG4gICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICB0eXBlOiBcInJlc3BvbnNlLW1ldGFkYXRhXCIsXG4gICAgICAgIC4uLmdldFJlc3BvbnNlTWV0YWRhdGEodmFsdWUpXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHZhbHVlLmRvbmUpIHtcbiAgICAgIHRoaXMuaGFuZGxlRG9uZUNodW5rKHZhbHVlLCBjb250cm9sbGVyKTtcbiAgICB9XG4gICAgY29uc3QgZGVsdGEgPSB2YWx1ZSA9PSBudWxsID8gdm9pZCAwIDogdmFsdWUubWVzc2FnZTtcbiAgICBpZiAoZGVsdGEpIHtcbiAgICAgIHRoaXMucHJvY2Vzc0RlbHRhKGRlbHRhLCBjb250cm9sbGVyKTtcbiAgICB9XG4gIH1cbiAgaGFuZGxlRG9uZUNodW5rKHZhbHVlLCBjb250cm9sbGVyKSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgdGhpcy5zdGF0ZS5maW5pc2hSZWFzb24gPSBtYXBPbGxhbWFGaW5pc2hSZWFzb24odmFsdWUuZG9uZV9yZWFzb24pO1xuICAgIHRoaXMuc3RhdGUudXNhZ2UgPSB7XG4gICAgICBpbnB1dFRva2VuczogdmFsdWUucHJvbXB0X2V2YWxfY291bnQgfHwgMCxcbiAgICAgIG91dHB1dFRva2VuczogKF9hID0gdmFsdWUuZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9hIDogdm9pZCAwLFxuICAgICAgdG90YWxUb2tlbnM6ICgoX2IgPSB2YWx1ZS5wcm9tcHRfZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9iIDogMCkgKyAoKF9jID0gdmFsdWUuZXZhbF9jb3VudCkgIT0gbnVsbCA/IF9jIDogMClcbiAgICB9O1xuICAgIGlmICh0aGlzLnN0YXRlLmhhc1RleHRTdGFydGVkICYmICF0aGlzLnN0YXRlLnRleHRFbmRlZCkge1xuICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogXCJ0ZXh0LWVuZFwiLCBpZDogdGhpcy5zdGF0ZS50ZXh0SWQgfSk7XG4gICAgICB0aGlzLnN0YXRlLnRleHRFbmRlZCA9IHRydWU7XG4gICAgfVxuICAgIGlmICh0aGlzLnN0YXRlLmhhc1JlYXNvbmluZ1N0YXJ0ZWQgJiYgIXRoaXMuc3RhdGUucmVhc29uaW5nRW5kZWQpIHtcbiAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6IFwicmVhc29uaW5nLWVuZFwiLCBpZDogXCIwXCIgfSk7XG4gICAgICB0aGlzLnN0YXRlLnJlYXNvbmluZ0VuZGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcHJvY2Vzc0RlbHRhKGRlbHRhLCBjb250cm9sbGVyKSB7XG4gICAgdGhpcy5wcm9jZXNzVGV4dENvbnRlbnQoZGVsdGEsIGNvbnRyb2xsZXIpO1xuICAgIHRoaXMucHJvY2Vzc1RoaW5raW5nKGRlbHRhLCBjb250cm9sbGVyKTtcbiAgICB0aGlzLnByb2Nlc3NUb29sQ2FsbHMoZGVsdGEsIGNvbnRyb2xsZXIpO1xuICB9XG4gIHByb2Nlc3NUZXh0Q29udGVudChkZWx0YSwgY29udHJvbGxlcikge1xuICAgIGlmICgoZGVsdGEgPT0gbnVsbCA/IHZvaWQgMCA6IGRlbHRhLmNvbnRlbnQpICE9IG51bGwpIHtcbiAgICAgIGlmICghdGhpcy5zdGF0ZS5oYXNUZXh0U3RhcnRlZCkge1xuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiBcInRleHQtc3RhcnRcIiwgaWQ6IHRoaXMuc3RhdGUudGV4dElkIH0pO1xuICAgICAgICB0aGlzLnN0YXRlLmhhc1RleHRTdGFydGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgIHR5cGU6IFwidGV4dC1kZWx0YVwiLFxuICAgICAgICBpZDogdGhpcy5zdGF0ZS50ZXh0SWQsXG4gICAgICAgIGRlbHRhOiBkZWx0YS5jb250ZW50XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgcHJvY2Vzc1RoaW5raW5nKGRlbHRhLCBjb250cm9sbGVyKSB7XG4gICAgaWYgKGRlbHRhID09IG51bGwgPyB2b2lkIDAgOiBkZWx0YS50aGlua2luZykge1xuICAgICAgaWYgKCF0aGlzLnN0YXRlLmhhc1JlYXNvbmluZ1N0YXJ0ZWQpIHtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogXCJyZWFzb25pbmctc3RhcnRcIiwgaWQ6IFwiMFwiIH0pO1xuICAgICAgICB0aGlzLnN0YXRlLmhhc1JlYXNvbmluZ1N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgdHlwZTogXCJyZWFzb25pbmctZGVsdGFcIixcbiAgICAgICAgaWQ6IFwiMFwiLFxuICAgICAgICBkZWx0YTogZGVsdGEudGhpbmtpbmdcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBwcm9jZXNzVG9vbENhbGxzKGRlbHRhLCBjb250cm9sbGVyKSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICAgIGZvciAoY29uc3QgdG9vbENhbGwgb2YgKF9hID0gZGVsdGEudG9vbF9jYWxscykgIT0gbnVsbCA/IF9hIDogW10pIHtcbiAgICAgIGlmICgoKF9iID0gdG9vbENhbGwuZnVuY3Rpb24pID09IG51bGwgPyB2b2lkIDAgOiBfYi5uYW1lKSA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkUmVzcG9uc2VEYXRhRXJyb3Ioe1xuICAgICAgICAgIGRhdGE6IHRvb2xDYWxsLFxuICAgICAgICAgIG1lc3NhZ2U6IGBFeHBlY3RlZCAnZnVuY3Rpb24ubmFtZScgdG8gYmUgYSBzdHJpbmcuYFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICgoKF9jID0gdG9vbENhbGwuZnVuY3Rpb24pID09IG51bGwgPyB2b2lkIDAgOiBfYy5uYW1lKSAhPSBudWxsICYmICgoX2QgPSB0b29sQ2FsbC5mdW5jdGlvbikgPT0gbnVsbCA/IHZvaWQgMCA6IF9kLmFyZ3VtZW50cykgIT0gbnVsbCkge1xuICAgICAgICB0aGlzLmVtaXRUb29sQ2FsbCh0b29sQ2FsbCwgY29udHJvbGxlcik7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGVtaXRUb29sQ2FsbCh0b29sQ2FsbCwgY29udHJvbGxlcikge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZDtcbiAgICBjb25zdCBpZCA9IChfZCA9IHRvb2xDYWxsLmlkKSAhPSBudWxsID8gX2QgOiAoX2MgPSAoX2IgPSAoX2EgPSB0aGlzLmNvbmZpZykuZ2VuZXJhdGVJZCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EpKSAhPSBudWxsID8gX2MgOiBnZW5lcmF0ZUlkMygpO1xuICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICB0eXBlOiBcInRvb2wtaW5wdXQtc3RhcnRcIixcbiAgICAgIGlkLFxuICAgICAgdG9vbE5hbWU6IHRvb2xDYWxsLmZ1bmN0aW9uLm5hbWVcbiAgICB9KTtcbiAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgdHlwZTogXCJ0b29sLWlucHV0LWRlbHRhXCIsXG4gICAgICBpZCxcbiAgICAgIGRlbHRhOiBKU09OLnN0cmluZ2lmeSh0b29sQ2FsbC5mdW5jdGlvbi5hcmd1bWVudHMpXG4gICAgfSk7XG4gICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgIHR5cGU6IFwidG9vbC1pbnB1dC1lbmRcIixcbiAgICAgIGlkXG4gICAgfSk7XG4gICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgIHR5cGU6IFwidG9vbC1jYWxsXCIsXG4gICAgICB0b29sQ2FsbElkOiBpZCxcbiAgICAgIHRvb2xOYW1lOiB0b29sQ2FsbC5mdW5jdGlvbi5uYW1lLFxuICAgICAgaW5wdXQ6IEpTT04uc3RyaW5naWZ5KHRvb2xDYWxsLmZ1bmN0aW9uLmFyZ3VtZW50cylcbiAgICB9KTtcbiAgICB0aGlzLnN0YXRlLmhhc1Rvb2xDYWxscyA9IHRydWU7XG4gIH1cbiAgZmluYWxpemVTdHJlYW0oY29udHJvbGxlcikge1xuICAgIGlmICh0aGlzLnN0YXRlLmhhc1RleHRTdGFydGVkICYmICF0aGlzLnN0YXRlLnRleHRFbmRlZCkge1xuICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogXCJ0ZXh0LWVuZFwiLCBpZDogXCIwXCIgfSk7XG4gICAgfVxuICAgIGlmICh0aGlzLnN0YXRlLmhhc1JlYXNvbmluZ1N0YXJ0ZWQgJiYgIXRoaXMuc3RhdGUucmVhc29uaW5nRW5kZWQpIHtcbiAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6IFwicmVhc29uaW5nLWVuZFwiLCBpZDogXCIwXCIgfSk7XG4gICAgfVxuICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICB0eXBlOiBcImZpbmlzaFwiLFxuICAgICAgZmluaXNoUmVhc29uOiB0aGlzLnN0YXRlLmZpbmlzaFJlYXNvbixcbiAgICAgIHVzYWdlOiB0aGlzLnN0YXRlLnVzYWdlLFxuICAgICAgcHJvdmlkZXJNZXRhZGF0YToge1xuICAgICAgICBvbGxhbWE6IHtcbiAgICAgICAgICByZXNwb25zZUlkOiB0aGlzLnN0YXRlLnJlc3BvbnNlSWRcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG59O1xuXG4vLyBzcmMvcmVzcG9uc2VzL29sbGFtYS1yZXNwb25zZXMtbGFuZ3VhZ2UtbW9kZWwudHNcbnZhciBPbGxhbWFSZXNwb25zZXNMYW5ndWFnZU1vZGVsID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihtb2RlbElkLCBjb25maWcpIHtcbiAgICB0aGlzLnNwZWNpZmljYXRpb25WZXJzaW9uID0gXCJ2MlwiO1xuICAgIHRoaXMuc3VwcG9ydGVkVXJscyA9IHtcbiAgICAgIFwiaW1hZ2UvKlwiOiBbXG4gICAgICAgIC9eaHR0cHM/OlxcL1xcLy4qJC9cbiAgICAgIF1cbiAgICB9O1xuICAgIHRoaXMubW9kZWxJZCA9IG1vZGVsSWQ7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5yZXF1ZXN0QnVpbGRlciA9IG5ldyBPbGxhbWFSZXF1ZXN0QnVpbGRlcigpO1xuICAgIHRoaXMucmVzcG9uc2VQcm9jZXNzb3IgPSBuZXcgT2xsYW1hUmVzcG9uc2VQcm9jZXNzb3IoY29uZmlnKTtcbiAgfVxuICBnZXQgcHJvdmlkZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLnByb3ZpZGVyO1xuICB9XG4gIGFzeW5jIGRvR2VuZXJhdGUob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYXJnczogYm9keSwgd2FybmluZ3MgfSA9IGF3YWl0IHRoaXMucHJlcGFyZVJlcXVlc3Qob3B0aW9ucyk7XG4gICAgY29uc3Qge1xuICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgdmFsdWU6IHJlc3BvbnNlLFxuICAgICAgcmF3VmFsdWU6IHJhd1Jlc3BvbnNlXG4gICAgfSA9IGF3YWl0IHBvc3RKc29uVG9BcGkzKHtcbiAgICAgIHVybDogdGhpcy5jb25maWcudXJsKHtcbiAgICAgICAgcGF0aDogXCIvY2hhdFwiLFxuICAgICAgICBtb2RlbElkOiB0aGlzLm1vZGVsSWRcbiAgICAgIH0pLFxuICAgICAgaGVhZGVyczogY29tYmluZUhlYWRlcnMzKHRoaXMuY29uZmlnLmhlYWRlcnMoKSwgb3B0aW9ucy5oZWFkZXJzKSxcbiAgICAgIGJvZHk6IHsgLi4uYm9keSwgc3RyZWFtOiBmYWxzZSB9LFxuICAgICAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyOiBvbGxhbWFGYWlsZWRSZXNwb25zZUhhbmRsZXIsXG4gICAgICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyOiBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyMyhiYXNlT2xsYW1hUmVzcG9uc2VTY2hlbWEyKSxcbiAgICAgIGFib3J0U2lnbmFsOiBvcHRpb25zLmFib3J0U2lnbmFsLFxuICAgICAgZmV0Y2g6IHRoaXMuY29uZmlnLmZldGNoXG4gICAgfSk7XG4gICAgY29uc3QgcHJvY2Vzc2VkUmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlUHJvY2Vzc29yLnByb2Nlc3NHZW5lcmF0ZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICByZXR1cm4ge1xuICAgICAgLi4ucHJvY2Vzc2VkUmVzcG9uc2UsXG4gICAgICByZXF1ZXN0OiB7IGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpIH0sXG4gICAgICByZXNwb25zZToge1xuICAgICAgICBtb2RlbElkOiB0aGlzLm1vZGVsSWQsXG4gICAgICAgIHRpbWVzdGFtcDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgYm9keTogcmF3UmVzcG9uc2VcbiAgICAgIH0sXG4gICAgICB3YXJuaW5nc1xuICAgIH07XG4gIH1cbiAgYXN5bmMgZG9TdHJlYW0ob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYXJnczogYm9keSwgd2FybmluZ3MgfSA9IGF3YWl0IHRoaXMucHJlcGFyZVJlcXVlc3Qob3B0aW9ucyk7XG4gICAgY29uc3QgeyByZXNwb25zZUhlYWRlcnMsIHZhbHVlOiByZXNwb25zZSB9ID0gYXdhaXQgcG9zdEpzb25Ub0FwaTMoe1xuICAgICAgdXJsOiB0aGlzLmNvbmZpZy51cmwoe1xuICAgICAgICBwYXRoOiBcIi9jaGF0XCIsXG4gICAgICAgIG1vZGVsSWQ6IHRoaXMubW9kZWxJZFxuICAgICAgfSksXG4gICAgICBoZWFkZXJzOiBjb21iaW5lSGVhZGVyczModGhpcy5jb25maWcuaGVhZGVycygpLCBvcHRpb25zLmhlYWRlcnMpLFxuICAgICAgYm9keTogeyAuLi5ib2R5LCBzdHJlYW06IHRydWUgfSxcbiAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogb2xsYW1hRmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvblN0cmVhbVJlc3BvbnNlSGFuZGxlcjIoYmFzZU9sbGFtYVJlc3BvbnNlU2NoZW1hMiksXG4gICAgICBhYm9ydFNpZ25hbDogb3B0aW9ucy5hYm9ydFNpZ25hbCxcbiAgICAgIGZldGNoOiB0aGlzLmNvbmZpZy5mZXRjaFxuICAgIH0pO1xuICAgIGNvbnN0IHN0cmVhbVByb2Nlc3NvciA9IG5ldyBPbGxhbWFTdHJlYW1Qcm9jZXNzb3IodGhpcy5jb25maWcpO1xuICAgIHJldHVybiB7XG4gICAgICBzdHJlYW06IHJlc3BvbnNlLnBpcGVUaHJvdWdoKFxuICAgICAgICBzdHJlYW1Qcm9jZXNzb3IuY3JlYXRlVHJhbnNmb3JtU3RyZWFtKHdhcm5pbmdzLCBvcHRpb25zKVxuICAgICAgKSxcbiAgICAgIHJlcXVlc3Q6IHsgYm9keSB9LFxuICAgICAgcmVzcG9uc2U6IHsgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzIH1cbiAgICB9O1xuICB9XG4gIGFzeW5jIHByZXBhcmVSZXF1ZXN0KG9wdGlvbnMpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5yZXF1ZXN0QnVpbGRlci5idWlsZFJlcXVlc3Qoe1xuICAgICAgbW9kZWxJZDogdGhpcy5tb2RlbElkLFxuICAgICAgLi4ub3B0aW9uc1xuICAgIH0pO1xuICB9XG59O1xuXG4vLyBzcmMvb2xsYW1hLXByb3ZpZGVyLnRzXG5mdW5jdGlvbiBjcmVhdGVPbGxhbWEob3B0aW9ucyA9IHt9KSB7XG4gIHZhciBfYSwgX2I7XG4gIGNvbnN0IGJhc2VVUkwgPSAoX2EgPSB3aXRob3V0VHJhaWxpbmdTbGFzaChvcHRpb25zLmJhc2VVUkwpKSAhPSBudWxsID8gX2EgOiBcImh0dHA6Ly8xMjcuMC4wLjE6MTE0MzQvYXBpXCI7XG4gIGNvbnN0IHByb3ZpZGVyTmFtZSA9IChfYiA9IG9wdGlvbnMubmFtZSkgIT0gbnVsbCA/IF9iIDogXCJvbGxhbWFcIjtcbiAgY29uc3QgZ2V0SGVhZGVycyA9ICgpID0+ICh7XG4gICAgXCJPbGxhbWEtT3JnYW5pemF0aW9uXCI6IG9wdGlvbnMub3JnYW5pemF0aW9uLFxuICAgIFwiT2xsYW1hLVByb2plY3RcIjogb3B0aW9ucy5wcm9qZWN0LFxuICAgIC4uLm9wdGlvbnMuaGVhZGVyc1xuICB9KTtcbiAgY29uc3QgY3JlYXRlQ29tcGxldGlvbk1vZGVsID0gKG1vZGVsSWQsIHNldHRpbmdzID0ge30pID0+IG5ldyBPbGxhbWFDb21wbGV0aW9uTGFuZ3VhZ2VNb2RlbChtb2RlbElkLCBzZXR0aW5ncywge1xuICAgIHByb3ZpZGVyOiBgJHtwcm92aWRlck5hbWV9LmNvbXBsZXRpb25gLFxuICAgIHVybDogKHsgcGF0aCB9KSA9PiBgJHtiYXNlVVJMfSR7cGF0aH1gLFxuICAgIGhlYWRlcnM6IGdldEhlYWRlcnMsXG4gICAgZmV0Y2g6IG9wdGlvbnMuZmV0Y2hcbiAgfSk7XG4gIGNvbnN0IGNyZWF0ZUVtYmVkZGluZ01vZGVsID0gKG1vZGVsSWQsIHNldHRpbmdzID0ge30pID0+IG5ldyBPbGxhbWFFbWJlZGRpbmdNb2RlbChtb2RlbElkLCBzZXR0aW5ncywge1xuICAgIHByb3ZpZGVyOiBgJHtwcm92aWRlck5hbWV9LmVtYmVkZGluZ2AsXG4gICAgdXJsOiAoeyBwYXRoIH0pID0+IGAke2Jhc2VVUkx9JHtwYXRofWAsXG4gICAgaGVhZGVyczogZ2V0SGVhZGVycyxcbiAgICBmZXRjaDogb3B0aW9ucy5mZXRjaFxuICB9KTtcbiAgY29uc3QgY3JlYXRlTGFuZ3VhZ2VNb2RlbCA9IChtb2RlbElkKSA9PiB7XG4gICAgaWYgKG5ldy50YXJnZXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJUaGUgT2xsYW1hIG1vZGVsIGZ1bmN0aW9uIGNhbm5vdCBiZSBjYWxsZWQgd2l0aCB0aGUgbmV3IGtleXdvcmQuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVSZXNwb25zZXNNb2RlbChtb2RlbElkKTtcbiAgfTtcbiAgY29uc3QgY3JlYXRlUmVzcG9uc2VzTW9kZWwgPSAobW9kZWxJZCkgPT4ge1xuICAgIHJldHVybiBuZXcgT2xsYW1hUmVzcG9uc2VzTGFuZ3VhZ2VNb2RlbChtb2RlbElkLCB7XG4gICAgICBwcm92aWRlcjogYCR7cHJvdmlkZXJOYW1lfS5yZXNwb25zZXNgLFxuICAgICAgdXJsOiAoeyBwYXRoIH0pID0+IGAke2Jhc2VVUkx9JHtwYXRofWAsXG4gICAgICBoZWFkZXJzOiBnZXRIZWFkZXJzLFxuICAgICAgZmV0Y2g6IG9wdGlvbnMuZmV0Y2hcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgcHJvdmlkZXIgPSBmdW5jdGlvbihtb2RlbElkKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUxhbmd1YWdlTW9kZWwobW9kZWxJZCk7XG4gIH07XG4gIHByb3ZpZGVyLmxhbmd1YWdlTW9kZWwgPSBjcmVhdGVMYW5ndWFnZU1vZGVsO1xuICBwcm92aWRlci5jaGF0ID0gY3JlYXRlTGFuZ3VhZ2VNb2RlbDtcbiAgcHJvdmlkZXIuY29tcGxldGlvbiA9IGNyZWF0ZUNvbXBsZXRpb25Nb2RlbDtcbiAgcHJvdmlkZXIuZW1iZWRkaW5nID0gY3JlYXRlRW1iZWRkaW5nTW9kZWw7XG4gIHByb3ZpZGVyLnRleHRFbWJlZGRpbmcgPSBjcmVhdGVFbWJlZGRpbmdNb2RlbDtcbiAgcHJvdmlkZXIudGV4dEVtYmVkZGluZ01vZGVsID0gY3JlYXRlRW1iZWRkaW5nTW9kZWw7XG4gIHByb3ZpZGVyLmltYWdlTW9kZWwgPSAobW9kZWxJZCkgPT4ge1xuICAgIHRocm93IG5ldyBOb1N1Y2hNb2RlbEVycm9yKHtcbiAgICAgIG1vZGVsSWQsXG4gICAgICBtb2RlbFR5cGU6IFwiaW1hZ2VNb2RlbFwiLFxuICAgICAgbWVzc2FnZTogXCJJbWFnZSBnZW5lcmF0aW9uIGlzIHVuc3VwcG9ydGVkIHdpdGggT2xsYW1hXCJcbiAgICB9KTtcbiAgfTtcbiAgcmV0dXJuIHByb3ZpZGVyO1xufVxudmFyIG9sbGFtYSA9IGNyZWF0ZU9sbGFtYSgpO1xuZXhwb3J0IHtcbiAgY3JlYXRlT2xsYW1hLFxuICBvbGxhbWFcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/ollama-ai-provider-v2@1.5.4_zod@4.1.12/node_modules/ollama-ai-provider-v2/dist/index.mjs\n");

/***/ })

};
;